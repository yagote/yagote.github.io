<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>MyBatis | 虾壳</title><meta name="author" content="虾壳"><meta name="copyright" content="虾壳"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="尚硅谷视频  一、简介1、MyBatis是什么(1) MyBatis 是支持定制化 SQL、存储过程以及高级映射的优秀的持久层框架； (2) MyBatis 避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集； (3) MyBatis可以使用简单的XML或注解用于配置和原始映射，将接口和Java的POJO（Plain Old Java Objects，普通的Java对象）映射成数据库中">
<meta property="og:type" content="article">
<meta property="og:title" content="MyBatis">
<meta property="og:url" content="http://yagote.github.io/2023/10/02/mybatis/index.html">
<meta property="og:site_name" content="虾壳">
<meta property="og:description" content="尚硅谷视频  一、简介1、MyBatis是什么(1) MyBatis 是支持定制化 SQL、存储过程以及高级映射的优秀的持久层框架； (2) MyBatis 避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集； (3) MyBatis可以使用简单的XML或注解用于配置和原始映射，将接口和Java的POJO（Plain Old Java Objects，普通的Java对象）映射成数据库中">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://yagote.github.io/img/favicon.png">
<meta property="article:published_time" content="2023-10-02T02:59:03.000Z">
<meta property="article:modified_time" content="2023-10-02T03:07:22.383Z">
<meta property="article:author" content="虾壳">
<meta property="article:tag" content="教程">
<meta property="article:tag" content="MyBatis">
<meta property="article:tag" content="MyBatis Plus">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yagote.github.io/img/favicon.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://yagote.github.io/2023/10/02/mybatis/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'MyBatis',
  isPost: true,
  isHome: false,
  isHighlightShrink: undefined,
  isToc: true,
  postUpdate: '2023-10-02 11:07:22'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/favicon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">36</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">38</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="虾壳"><span class="site-name">虾壳</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">MyBatis</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-10-02T02:59:03.000Z" title="发表于 2023-10-02 10:59:03">2023-10-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-10-02T03:07:22.383Z" title="更新于 2023-10-02 11:07:22">2023-10-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java/">Java</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java/Java%E6%95%99%E7%A8%8B/">Java教程</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">22.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>107分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="MyBatis"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1VP4y1c7j7">尚硅谷视频</a></p>
</blockquote>
<h4 id="一、简介"><a href="#一、简介" class="headerlink" title="一、简介"></a>一、简介</h4><h5 id="1、MyBatis是什么"><a href="#1、MyBatis是什么" class="headerlink" title="1、MyBatis是什么"></a>1、MyBatis是什么</h5><p>(1) MyBatis 是支持定制化 SQL、存储过程以及高级映射的优秀的持久层框架；</p>
<p>(2) MyBatis 避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集；</p>
<p>(3) MyBatis可以使用简单的XML或注解用于配置和原始映射，将接口和Java的<strong>POJO（Plain Old Java Objects，普通的Java对象）</strong>映射成数据库中的记录；</p>
<p>(4) MyBatis 是一个 半自动的<strong>ORM（Object Relation Mapping）</strong>框架。ORM是对象关系映射，对象指的是Java中的实体对象，关系指的是关系型数据库。</p>
<p><a target="_blank" rel="noopener" href="https://mybatis.net.cn/">中文文档</a></p>
<p>MyBatis下载地址：<a target="_blank" rel="noopener" href="https://github.com/mybatis/mybatis-3">https://github.com/mybatis/mybatis-3</a></p>
<h5 id="2、和其它持久化层技术对比"><a href="#2、和其它持久化层技术对比" class="headerlink" title="2、和其它持久化层技术对比"></a>2、和其它持久化层技术对比</h5><p>(1) JDBC</p>
<p>SQL 夹杂在Java代码中耦合度高，导致硬编码内伤；维护不易且实际开发需求中 SQL 有变化，频繁修改的情况多见；代码冗长，开发效率低。</p>
<p>(2) Hibernate 和 JPA</p>
<p>操作简便，开发效率高；程序中的长难复杂 SQL 需要绕过框架；内部自动生产的 SQL，不容易做特殊优化；基于全映射的全自动框架，大量字段的 POJO 进行部分映射时比较困难；反射操作太多，导致数据库性能下降。</p>
<p>(3) MyBatis</p>
<p>轻量级，性能出色；SQL 和 Java 编码分开，功能边界清晰。Java代码专注业务、SQL语句专注数据；开发效率稍逊于HIbernate，但是完全能够接受。</p>
<h4 id="二、搭建MyBatis"><a href="#二、搭建MyBatis" class="headerlink" title="二、搭建MyBatis"></a>二、搭建MyBatis</h4><h5 id="1、创建maven工程"><a href="#1、创建maven工程" class="headerlink" title="1、创建maven工程"></a>1、创建maven工程</h5><p>就是普通的maven工程，通过配置使得支持MyBatis。这里使用了一个文件夹下多个项目的做法：</p>
<img src="https://raw.githubusercontent.com/yagote/blog-image/master/202310021103659.png" alt="image-20220505002636239" style="zoom:80%;" />

<p>再通过【new module】就可以在这个只有.idea文件夹的文件夹下创建多个maven工程了，做法与创建SpringMVC工程类似。</p>
<img src="https://raw.githubusercontent.com/yagote/blog-image/master/202310021103660.png" alt="image-20220505002913221" style="zoom: 80%;" />

<h5 id="2、配置"><a href="#2、配置" class="headerlink" title="2、配置"></a>2、配置</h5><h6 id="2-1-pom-xml配置"><a href="#2-1-pom-xml配置" class="headerlink" title="2.1 pom.xml配置"></a>2.1 pom.xml配置</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mybatis01<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis01<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Mybatis核心 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- junit测试 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- MySQL驱动 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- log4j日志 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h6 id="2-2-mybatis-config-xml配置"><a href="#2-2-mybatis-config-xml配置" class="headerlink" title="2.2 mybatis-config.xml配置"></a>2.2 mybatis-config.xml配置</h6><p>这个文件在【resources】下</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">      environments：配置多个连接数据库的环境</span></span><br><span class="line"><span class="comment">      属性：</span></span><br><span class="line"><span class="comment">          default：设置默认使用的环境的id</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            environment：配置某个具体的环境</span></span><br><span class="line"><span class="comment">            属性：</span></span><br><span class="line"><span class="comment">                id：表示连接数据库的环境的唯一标识，不能重复</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">                transactionManager：设置事务管理方式</span></span><br><span class="line"><span class="comment">                属性：</span></span><br><span class="line"><span class="comment">                    type=&quot;JDBC|MANAGED&quot;</span></span><br><span class="line"><span class="comment">                    JDBC：表示当前环境中，执行SQL时，使用的是JDBC中原生的事务管理方式，事务的提交或回滚需要手动处理</span></span><br><span class="line"><span class="comment">                    MANAGED：被管理，例如Spring</span></span><br><span class="line"><span class="comment">            --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">                dataSource：配置数据源</span></span><br><span class="line"><span class="comment">                属性：</span></span><br><span class="line"><span class="comment">                type：设置数据源的类型</span></span><br><span class="line"><span class="comment">                type=&quot;POOLED|UNPOOLED|JNDI&quot;</span></span><br><span class="line"><span class="comment">                POOLED：表示使用数据库连接池缓存数据库连接</span></span><br><span class="line"><span class="comment">                UNPOOLED：表示不使用数据库连接池</span></span><br><span class="line"><span class="comment">                JNDI：表示使用上下文中的数据源</span></span><br><span class="line"><span class="comment">            --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/mybatis&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123456&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--引入映射文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;mappers/UserMapper.xml&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="三、核心配置文件详解"><a href="#三、核心配置文件详解" class="headerlink" title="三、核心配置文件详解"></a>三、核心配置文件详解</h4><p>==讲解mybatis-config.xml的配置==</p>
<p>核心配置文件中的标签必须按照固定的顺序：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">properties?,settings?,typeAliases?,typeHandlers?,objectFactory?,objectWrapperFactory?,<span class="built_in">ref</span>lectorF</span><br><span class="line">actory?,plugins?,environments?,databaseIdProvider?,mappers?</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xmlversion=&quot;1.0&quot;encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPEconfiguration</span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span><span class="meta-string">&quot;-//MyBatis.org//DTDConfig3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">&quot;http://MyBatis.org/dtd/MyBatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--引入properties文件，此时就可以$&#123;属性名&#125;的方式访问属性值--&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;jdbc.properties&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--将表中字段的下划线自动转换为驼峰--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;mapUnderscoreToCamelCase&quot;</span><span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span>    <span class="comment">&lt;!--开启延迟加载--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;lazyLoadingEnabled&quot;</span><span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">          typeAlias：设置某个具体的类型的别名</span></span><br><span class="line"><span class="comment">          属性：</span></span><br><span class="line"><span class="comment">          type：需要设置别名的类型的全类名</span></span><br><span class="line"><span class="comment">          alias：设置此类型的别名，若不设置此属性，该类型拥有默认的别名，即类名且不区分大小写,若设置此属性，此时该类型的别名只能使用alias所设置的值--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;typeAliastype=&quot;com.atguigu.mybatis.bean.User&quot;&gt;&lt;/typeAlias&gt;--&gt;</span>    <span class="comment">&lt;!--&lt;typeAliastype=&quot;com.atguigu.mybatis.bean.User&quot;alias=&quot;abc&quot;&gt;&lt;/typeAlias&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--以包为单位，设置改包下所有的类型都拥有默认的别名，即类名且不区分大小写--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.atguigu.mybatis.bean&quot;</span>/&gt;</span></span><br><span class="line">  	<span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            environments：设置多个连接数据库的环境</span></span><br><span class="line"><span class="comment">            属性：</span></span><br><span class="line"><span class="comment">            default：设置默认使用的环境的id</span></span><br><span class="line"><span class="comment">      --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;mysql_test&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">      environment：设置具体的连接数据库的环境信息</span></span><br><span class="line"><span class="comment">      属性：</span></span><br><span class="line"><span class="comment">      id：设置环境的唯一标识，可通过environments标签中的default设置某一个环境的id，表示默认使用的环境</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;mysql_test&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        transactionManager：设置事务管理方式</span></span><br><span class="line"><span class="comment">        属性：</span></span><br><span class="line"><span class="comment">        type：设置事务管理方式，type=&quot;JDBC|MANAGED&quot;</span></span><br><span class="line"><span class="comment">        type=&quot;JDBC&quot;：设置当前环境的事务管理都必须手动处理</span></span><br><span class="line"><span class="comment">        type=&quot;MANAGED&quot;：设置事务被管理，例如spring中的AOP</span></span><br><span class="line"><span class="comment">      --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        dataSource：设置数据源</span></span><br><span class="line"><span class="comment">        属性：</span></span><br><span class="line"><span class="comment">        type：设置数据源的类型，type=&quot;POOLED|UNPOOLED|JNDI&quot;</span></span><br><span class="line"><span class="comment">        type=&quot;POOLED&quot;：使用数据库连接池，即会将创建的连接进行缓存，下次使用可以从缓存中直接获取，不需要重新创建</span></span><br><span class="line"><span class="comment">        type=&quot;UNPOOLED&quot;：不使用数据库连接池，即每次使用连接都需要重新创建</span></span><br><span class="line"><span class="comment">        type=&quot;JNDI&quot;：调用上下文中的数据源</span></span><br><span class="line"><span class="comment">      --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--设置驱动类的全类名--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span><span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--设置连接数据库的连接地址--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span><span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--设置连接数据库的用户名--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span><span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--设置连接数据库的密码--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span><span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--引入映射文件--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;UserMapper.xml&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">      以包为单位，将包下所有的映射文件引入核心配置文件</span></span><br><span class="line"><span class="comment">      注意：此方式必须保证mapper接口和mapper映射文件必须在相同的包下</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.atguigu.mybatis.mapper&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="四、MyBatis的增删改查"><a href="#四、MyBatis的增删改查" class="headerlink" title="四、MyBatis的增删改查"></a>四、MyBatis的增删改查</h4><p>实体类User.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mybatis.pojo;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 实体类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yagote    create 2022/5/5 17:06</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(Integer id, String username, String password, Integer age, String sex, String email)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.username = username;</span><br><span class="line">        <span class="keyword">this</span>.password = password;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">        <span class="keyword">this</span>.email = email;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPassword</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(Integer age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getEmail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> email;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEmail</span><span class="params">(String email)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.email = email;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">                <span class="string">&quot;, username=&#x27;&quot;</span> + username + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, password=&#x27;&quot;</span> + password + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&quot;, sex=&#x27;&quot;</span> + sex + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, email=&#x27;&quot;</span> + email + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>实体类的数据库映射接口UserMapper.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mybatis.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mybatis.pojo.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 映射文件UserMapper.xml对应的接口</span></span><br><span class="line"><span class="comment"> * 与MyBatis的数据库处理文件一致，为配置文件声明增删改查</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yagote    create 2022/5/5 17:11</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * MyBatis面向接口编程的两个一致：</span></span><br><span class="line"><span class="comment">     * 1、映射文件的namespace要和mapper接口的全类名保持一致</span></span><br><span class="line"><span class="comment">     * 2、映射文件中SQL语句的id要和mapper接口中的方法名一致</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * 表--实体类--mapper接口--映射文件</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加用户信息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">insertUser</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 修改用户信息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">updateUser</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除用户信息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deleteUser</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询单个用户信息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">User <span class="title">getUserById</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有用户信息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">getAllUser</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>mybatis-config-xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--设置类型别名--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            typeAlias：设置某个类型的别名</span></span><br><span class="line"><span class="comment">            属性：</span></span><br><span class="line"><span class="comment">                type：设置需要设置别名的类型</span></span><br><span class="line"><span class="comment">                alias：设置某个类型的别名，若不设置该属性，那么该类型拥有默认的别名，即类名且不区分大小写</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;typeAlias type=&quot;com.mybatis.pojo.User&quot;&gt;&lt;/typeAlias&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--以包为单位，将包下所有的类型设置默认的类型别名，即类名且不区分大小写--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.mybatis.pojo&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">      environments：配置多个连接数据库的环境</span></span><br><span class="line"><span class="comment">      属性：</span></span><br><span class="line"><span class="comment">          default：设置默认使用的环境的id</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            environment：配置某个具体的环境</span></span><br><span class="line"><span class="comment">            属性：</span></span><br><span class="line"><span class="comment">                id：表示连接数据库的环境的唯一标识，不能重复</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">                transactionManager：设置事务管理方式</span></span><br><span class="line"><span class="comment">                属性：</span></span><br><span class="line"><span class="comment">                    type=&quot;JDBC|MANAGED&quot;</span></span><br><span class="line"><span class="comment">                    JDBC：表示当前环境中，执行SQL时，使用的是JDBC中原生的事务管理方式，事务的提交或回滚需要手动处理</span></span><br><span class="line"><span class="comment">                    MANAGED：被管理，例如Spring</span></span><br><span class="line"><span class="comment">            --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">                dataSource：配置数据源</span></span><br><span class="line"><span class="comment">                属性：</span></span><br><span class="line"><span class="comment">                type：设置数据源的类型</span></span><br><span class="line"><span class="comment">                type=&quot;POOLED|UNPOOLED|JNDI&quot;</span></span><br><span class="line"><span class="comment">                POOLED：表示使用数据库连接池缓存数据库连接</span></span><br><span class="line"><span class="comment">                UNPOOLED：表示不使用数据库连接池</span></span><br><span class="line"><span class="comment">                JNDI：表示使用上下文中的数据源</span></span><br><span class="line"><span class="comment">            --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/mybatis&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--引入映射文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;mappers/UserMapper.xml&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>





<p>MyBatis数据库操作文件UserMapper.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.mybatis.mapper.UserMapper&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--int insertUser();--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertUser&quot;</span>&gt;</span></span><br><span class="line">        insert into t_user values(null,&#x27;admin&#x27;,&#x27;123456&#x27;,23,&#x27;男&#x27;,&#x27;12345@qq.com&#x27;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--void updateUser();--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateUser&quot;</span>&gt;</span></span><br><span class="line">        update t_user set username = &#x27;张三&#x27; where id = 4</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--void deleteUser();--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteUser&quot;</span>&gt;</span></span><br><span class="line">        delete from t_user where id = 4</span><br><span class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--User getUserById();--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        查询功能的标签必须设置resultType或resultMap</span></span><br><span class="line"><span class="comment">        resultType：设置默认的映射关系</span></span><br><span class="line"><span class="comment">        resultMap：设置自定义的映射关系</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.mybatis.pojo.User&quot;</span>&gt;</span></span><br><span class="line">        select * from t_user where id = 3</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--List&lt;User&gt; getAllUser();--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getAllUser&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">        select * from t_user</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>测试MyBatisTest.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mybatis.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mybatis.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> com.mybatis.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试文件</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yagote    create 2022/5/5 23:39</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisTest</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * SqlSession默认不自动提交事务，若需要自动提交事务</span></span><br><span class="line"><span class="comment">     * 可以使用SqlSessionFactory.openSession(true);</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMyBatis</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//加载核心配置文件</span></span><br><span class="line">        InputStream is = Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//获取SqlSessionFactoryBuilder</span></span><br><span class="line">        SqlSessionFactoryBuilder sqlSessionFactoryBuilder = <span class="keyword">new</span> SqlSessionFactoryBuilder();</span><br><span class="line">        <span class="comment">//获取sqlSessionFactory</span></span><br><span class="line">        SqlSessionFactory sqlSessionFactory = sqlSessionFactoryBuilder.build(is);</span><br><span class="line">        <span class="comment">//获取SqlSession</span></span><br><span class="line">        SqlSession sqlSession = sqlSessionFactory.openSession(<span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">//获取mapper接口对象</span></span><br><span class="line">        UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">        <span class="comment">//测试功能</span></span><br><span class="line">        <span class="keyword">int</span> result = mapper.insertUser();</span><br><span class="line">        <span class="comment">//提交事务</span></span><br><span class="line">        <span class="comment">//sqlSession.commit();</span></span><br><span class="line">        System.out.println(<span class="string">&quot;result:&quot;</span>+result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCRUD</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        InputStream is = Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">        SqlSession sqlSession = sqlSessionFactory.openSession(<span class="keyword">true</span>);</span><br><span class="line">        UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">        <span class="comment">//mappers.updateUser();</span></span><br><span class="line">        <span class="comment">//mappers.deleteUser();</span></span><br><span class="line">        <span class="comment">/*User user = mappers.getUserById();</span></span><br><span class="line"><span class="comment">        System.out.println(user);*/</span></span><br><span class="line">        List&lt;User&gt; list = mapper.getAllUser();</span><br><span class="line">        list.forEach(user -&gt; System.out.println(user));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="1、添加"><a href="#1、添加" class="headerlink" title="1、添加"></a>1、添加</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--int insertUser();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertUser&quot;</span>&gt;</span></span><br><span class="line">    insert into t_user values(null,&#x27;admin&#x27;,&#x27;123456&#x27;,23,&#x27;男&#x27;,&#x27;12345@qq.com&#x27;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsert</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    <span class="comment">//加载核心配置文件</span></span><br><span class="line">    InputStream is = Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line">    <span class="comment">//获取SqlSessionFactoryBuilder</span></span><br><span class="line">    SqlSessionFactoryBuilder sqlSessionFactoryBuilder = <span class="keyword">new</span> SqlSessionFactoryBuilder();</span><br><span class="line">    <span class="comment">//获取sqlSessionFactory</span></span><br><span class="line">    SqlSessionFactory sqlSessionFactory = sqlSessionFactoryBuilder.build(is);</span><br><span class="line">    <span class="comment">//获取SqlSession</span></span><br><span class="line">    SqlSession sqlSession = sqlSessionFactory.openSession(<span class="keyword">true</span>);</span><br><span class="line">    <span class="comment">//获取mapper接口对象</span></span><br><span class="line">    UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">    <span class="comment">//测试功能</span></span><br><span class="line">    <span class="keyword">int</span> result = mapper.insertUser();</span><br><span class="line">    <span class="comment">//提交事务</span></span><br><span class="line">    <span class="comment">//sqlSession.commit();</span></span><br><span class="line">    System.out.println(<span class="string">&quot;result:&quot;</span>+result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>控制台输出</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">06</span> <span class="number">15</span>:<span class="number">38</span>:<span class="number">19</span>,<span class="number">163</span> ==&gt;  Preparing: insert into t_user values(null,&#x27;admin&#x27;,&#x27;<span class="number">123456</span>&#x27;,<span class="number">23</span>,&#x27;男&#x27;,&#x27;<span class="number">12345</span>@qq.com&#x27;)  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">06</span> <span class="number">15</span>:<span class="number">38</span>:<span class="number">19</span>,<span class="number">288</span> ==&gt; Parameters:   (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">06</span> <span class="number">15</span>:<span class="number">38</span>:<span class="number">19</span>,<span class="number">428</span> &lt;==    Updates: <span class="number">1</span>  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">result</span>:<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/yagote/blog-image/master/202310021103661.png" alt="image-20220506153948398"></p>
<h5 id="2、修改"><a href="#2、修改" class="headerlink" title="2、修改"></a>2、修改</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--void updateUser();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateUser&quot;</span>&gt;</span></span><br><span class="line">    update t_user set username = &#x27;张三&#x27; where id = 4</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCRUD</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    InputStream is = Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line">    SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">    SqlSession sqlSession = sqlSessionFactory.openSession(<span class="keyword">true</span>);</span><br><span class="line">    UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">    mapper.updateUser();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>控制台输出</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">06</span> <span class="number">15</span>:<span class="number">42</span>:<span class="number">15</span>,<span class="number">904</span> ==&gt;  Preparing: update t_user set username = &#x27;张三&#x27; where id = <span class="number">4</span>  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">06</span> <span class="number">15</span>:<span class="number">42</span>:<span class="number">16</span>,<span class="number">009</span> ==&gt; Parameters:   (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">06</span> <span class="number">15</span>:<span class="number">42</span>:<span class="number">16</span>,<span class="number">266</span> &lt;==    Updates: <span class="number">1</span>  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/yagote/blog-image/master/202310021103662.png" alt="image-20220506154407171"></p>
<h5 id="3、删除"><a href="#3、删除" class="headerlink" title="3、删除"></a>3、删除</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--void deleteUser();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteUser&quot;</span>&gt;</span></span><br><span class="line">    delete from t_user where id = 4</span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCRUD</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    InputStream is = Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line">    SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">    SqlSession sqlSession = sqlSessionFactory.openSession(<span class="keyword">true</span>);</span><br><span class="line">    UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">    mapper.deleteUser();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>控制台输出</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">06</span> <span class="number">15</span>:<span class="number">45</span>:<span class="number">35</span>,<span class="number">706</span> ==&gt;  Preparing: delete from t_user where id = <span class="number">4</span>  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">06</span> <span class="number">15</span>:<span class="number">45</span>:<span class="number">35</span>,<span class="number">753</span> ==&gt; Parameters:   (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">06</span> <span class="number">15</span>:<span class="number">45</span>:<span class="number">36</span>,<span class="number">052</span> &lt;==    Updates: <span class="number">1</span>  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br></pre></td></tr></table></figure>

<p>数据库中已无id为4的记录</p>
<img src="https://raw.githubusercontent.com/yagote/blog-image/master/202310021103663.png" alt="image-20220506154623602" style="zoom:67%;" />

<h5 id="4、查询单个"><a href="#4、查询单个" class="headerlink" title="4、查询单个"></a>4、查询单个</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.mybatis.pojo.User&quot;</span>&gt;</span></span><br><span class="line">    select * from t_user where id = 3</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCRUD</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    InputStream is = Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line">    SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">    SqlSession sqlSession = sqlSessionFactory.openSession(<span class="keyword">true</span>);</span><br><span class="line">    UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">    User user = mapper.getUserById();</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>控制台输出</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">06</span> <span class="number">15</span>:<span class="number">47</span>:<span class="number">46</span>,<span class="number">714</span> ==&gt;  Preparing: select * from t_user where id = <span class="number">3</span>  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">06</span> <span class="number">15</span>:<span class="number">47</span>:<span class="number">46</span>,<span class="number">762</span> ==&gt; Parameters:   (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">06</span> <span class="number">15</span>:<span class="number">47</span>:<span class="number">46</span>,<span class="number">907</span> &lt;==      Total: <span class="number">1</span>  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">User</span>&#123;id=<span class="number">3</span>, username=&#x27;admin&#x27;, password=&#x27;<span class="number">123456</span>&#x27;, age=<span class="number">23</span>, sex=&#x27;男&#x27;, email=&#x27;<span class="number">12345</span>@qq.com&#x27;&#125;</span><br></pre></td></tr></table></figure>



<h5 id="5、查询所有"><a href="#5、查询所有" class="headerlink" title="5、查询所有"></a>5、查询所有</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--List&lt;User&gt; getAllUser();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getAllUser&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    select * from t_user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCRUD</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    InputStream is = Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line">    SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">    SqlSession sqlSession = sqlSessionFactory.openSession(<span class="keyword">true</span>);</span><br><span class="line">    UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">    List&lt;User&gt; list = mapper.getAllUser();</span><br><span class="line">    list.forEach(user -&gt; System.out.println(user));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>控制台输出</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">DEBUG</span> 05-06 15:49:14,578 ==&gt;  Preparing: select * <span class="keyword">from</span> t_user  (BaseJdbcLogger.java:137) </span><br><span class="line"><span class="builtin-name">DEBUG</span> 05-06 15:49:14,666 ==&gt; Parameters:   (BaseJdbcLogger.java:137) </span><br><span class="line"><span class="builtin-name">DEBUG</span> 05-06 15:49:14,810 &lt;==      Total: 2  (BaseJdbcLogger.java:137) </span><br><span class="line">User&#123;<span class="attribute">id</span>=2, <span class="attribute">username</span>=<span class="string">&#x27;admin&#x27;</span>, <span class="attribute">password</span>=<span class="string">&#x27;123456&#x27;</span>, <span class="attribute">age</span>=23, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;12345@qq.com&#x27;</span>&#125;</span><br><span class="line">User&#123;<span class="attribute">id</span>=3, <span class="attribute">username</span>=<span class="string">&#x27;admin&#x27;</span>, <span class="attribute">password</span>=<span class="string">&#x27;123456&#x27;</span>, <span class="attribute">age</span>=23, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;12345@qq.com&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>注意：</p>
<p>1、查询的标签select必须设置属性resultType或resultMap，用于设置实体类和数据库表的映射关系</p>
<p>​        resultType：自动映射，用于属性名和表中字段名一致的情况；</p>
<p>​        resultMap：自定义映射，用于一对多或多对一或字段名和属性名不一致的情况。</p>
<p>2、当查询的数据为多条时，不能使用实体类作为返回值，只能使用集合，否则会抛出异常TooManyResultsException；但是若查询的数据只有一条，可以使用实体类或集合作为返回值。</p>
</blockquote>
<h4 id="五、MyBatis获取参数值的两种方式（重点）"><a href="#五、MyBatis获取参数值的两种方式（重点）" class="headerlink" title="五、MyBatis获取参数值的两种方式（重点）"></a>五、MyBatis获取参数值的两种方式（重点）</h4><p>【代码在mybatis02】</p>
<p>MyBatis获取参数值的两种方式：**${}<strong>和</strong>#{}**</p>
<p><strong>${}的本质就是字符串拼接，#{}的本质就是占位符赋值</strong></p>
<p>${}使用字符串拼接的方式拼接sql，若为字符串类型或日期类型的字段进行赋值时，需要手动加单引号；但是#{}使用占位符赋值的方式拼接sql，此时为字符串类型或日期类型的字段进行赋值时，可以自动添加单引号。</p>
<p>封装数据库连接操作的工具类<code>SqlSessionUtils.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ya.mybatis.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yagote    create 2022/5/6 17:21</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SqlSessionUtils</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlSession <span class="title">getSqlSession</span><span class="params">()</span></span>&#123;</span><br><span class="line">        SqlSession sqlSession = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            InputStream is = Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line">            SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">            sqlSession = sqlSessionFactory.openSession(<span class="keyword">true</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sqlSession;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="1、单个字面量类型的参数"><a href="#1、单个字面量类型的参数" class="headerlink" title="1、单个字面量类型的参数"></a>1、单个字面量类型的参数</h5><p>若mapper接口中的方法参数为单个的字面量类型，此时可以使用<code>$&#123;&#125;</code>和<code>#&#123;&#125;</code>以任意的名称获取参数的值，注意<code>$&#123;&#125;</code>需要手动加单引号。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据用户名查询用户信息  //1、单个字面量类型的参数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">User <span class="title">getUserByUsername</span><span class="params">(String username)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--1、单个字面量类型的参数User getUserByUsername(String username);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserByUsername&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--select * from t_user where username = #&#123;username&#125;--&gt;</span></span><br><span class="line">    select * from t_user where username = &#x27;$&#123;username&#125;&#x27;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>   <span class="comment">//1、单个字面量类型的参数</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetUserByUsername</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = SqlSessionUtils.getSqlSession();</span><br><span class="line">    ParameterMapper mapper = sqlSession.getMapper(ParameterMapper.class);</span><br><span class="line">    User user = mapper.getUserByUsername(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">11</span>:<span class="number">43</span>:<span class="number">42</span>,<span class="number">816</span> ==&gt;  Preparing: select * from t_user where username = &#x27;admin&#x27;  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">11</span>:<span class="number">43</span>:<span class="number">42</span>,<span class="number">907</span> ==&gt; Parameters:   (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">11</span>:<span class="number">43</span>:<span class="number">43</span>,<span class="number">139</span> &lt;==      Total: <span class="number">1</span>  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">User</span>&#123;id=<span class="number">1</span>, username=&#x27;admin&#x27;, password=&#x27;<span class="number">123456</span>&#x27;, age=<span class="number">23</span>, sex=&#x27;男&#x27;, email=&#x27;<span class="number">12345</span>@qq.com&#x27;&#125;</span><br></pre></td></tr></table></figure>



<h5 id="2、多个字面量类型的参数"><a href="#2、多个字面量类型的参数" class="headerlink" title="==2、多个字面量类型的参数=="></a>==2、多个字面量类型的参数==</h5><p>若mapper接口中的方法参数为多个时，此时MyBatis会自动将这些参数放在一个map集合中，<strong>以arg0,arg1…为键，以参数为值；以param1,param2…为键，以参数为值</strong>；因此只需要通过<code>$&#123;&#125;</code>和<code>#&#123;&#125;</code>访问map集合的键就可以获取相对应的值，注意${}需要手动加单引号。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 验证登录 //2、多个字面量类型的参数</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function">User <span class="title">checkLogin</span><span class="params">(String username, String password)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--2、多个字面量类型的参数User checkLogin(String username, String password);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;checkLogin&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--select * from t_user where username = #&#123;arg0&#125; and password = #&#123;arg1&#125;--&gt;</span></span><br><span class="line">    select * from t_user where username = &#x27;$&#123;param1&#125;&#x27; and password = &#x27;$&#123;param2&#125;&#x27;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>   <span class="comment">//2、多个字面量类型的参数</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCheckLogin</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = SqlSessionUtils.getSqlSession();</span><br><span class="line">    ParameterMapper mapper = sqlSession.getMapper(ParameterMapper.class);</span><br><span class="line">    User user = mapper.checkLogin(<span class="string">&quot;admin&quot;</span>, <span class="string">&quot;123456&quot;</span>);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">11</span>:<span class="number">47</span>:<span class="number">00</span>,<span class="number">954</span> ==&gt;  Preparing: select * from t_user where username = &#x27;admin&#x27; and password = &#x27;<span class="number">123456</span>&#x27;  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">11</span>:<span class="number">47</span>:<span class="number">01</span>,<span class="number">003</span> ==&gt; Parameters:   (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">11</span>:<span class="number">47</span>:<span class="number">01</span>,<span class="number">474</span> &lt;==      Total: <span class="number">1</span>  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">User</span>&#123;id=<span class="number">1</span>, username=&#x27;admin&#x27;, password=&#x27;<span class="number">123456</span>&#x27;, age=<span class="number">23</span>, sex=&#x27;男&#x27;, email=&#x27;<span class="number">12345</span>@qq.com&#x27;&#125;</span><br></pre></td></tr></table></figure>



<h5 id="3、map集合类型的参数"><a href="#3、map集合类型的参数" class="headerlink" title="3、map集合类型的参数"></a>3、map集合类型的参数</h5><p>若mapper接口中的方法需要的参数为多个时，此时可以手动创建map集合，将这些数据放在map中，只需要通过<code>$&#123;&#125;</code>和<code>#&#123;&#125;</code>访问map集合的键就可以获取相对应的值，注意${}需要手动加单引号。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 验证登录（参数为map） //3、map集合类型的参数</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function">User <span class="title">checkLoginByMap</span><span class="params">(Map&lt;String, Object&gt; map)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--3、map集合类型的参数User checkLoginByMap(Map&lt;String, Object&gt; map);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;checkLoginByMap&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    select * from t_user where username = #&#123;username&#125; and password = #&#123;password&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>   <span class="comment">//3、map集合类型的参数</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCheckLoginByMap</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = SqlSessionUtils.getSqlSession();</span><br><span class="line">    ParameterMapper mapper = sqlSession.getMapper(ParameterMapper.class);</span><br><span class="line">    Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;admin&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;password&quot;</span>, <span class="string">&quot;123456&quot;</span>);</span><br><span class="line">    User user = mapper.checkLoginByMap(map);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">11</span>:<span class="number">48</span>:<span class="number">46</span>,<span class="number">726</span> ==&gt;  Preparing: select * from t_user where username = ? and password = ?  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">11</span>:<span class="number">48</span>:<span class="number">46</span>,<span class="number">794</span> ==&gt; Parameters: admin(String), <span class="number">123456</span>(String)  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">11</span>:<span class="number">48</span>:<span class="number">47</span>,<span class="number">052</span> &lt;==      Total: <span class="number">1</span>  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">User</span>&#123;id=<span class="number">1</span>, username=&#x27;admin&#x27;, password=&#x27;<span class="number">123456</span>&#x27;, age=<span class="number">23</span>, sex=&#x27;男&#x27;, email=&#x27;<span class="number">12345</span>@qq.com&#x27;&#125;</span><br></pre></td></tr></table></figure>



<h5 id="4、实体类类型的参数"><a href="#4、实体类类型的参数" class="headerlink" title="4、实体类类型的参数"></a>4、实体类类型的参数</h5><p>若mapper接口中的方法参数为实体类对象时，此时可以使用<code>$&#123;&#125;</code>和<code>#&#123;&#125;</code>，通过访问实体类对象中的属性名获取属性值，注意${}需要手动加单引号。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 添加用户信息   //4、实体类类型的参数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">insertUser</span><span class="params">(User user)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--4、实体类类型的参数int insertUser(User user);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertUser&quot;</span>&gt;</span></span><br><span class="line">    insert into t_user values(null,#&#123;username&#125;,#&#123;password&#125;,#&#123;age&#125;,#&#123;sex&#125;,#&#123;email&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>   <span class="comment">//4、实体类类型的参数</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsertUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = SqlSessionUtils.getSqlSession();</span><br><span class="line">    ParameterMapper mapper = sqlSession.getMapper(ParameterMapper.class);</span><br><span class="line">    <span class="keyword">int</span> result = mapper.insertUser(<span class="keyword">new</span> User(<span class="keyword">null</span>, <span class="string">&quot;李四&quot;</span>, <span class="string">&quot;123&quot;</span>, <span class="number">23</span>, <span class="string">&quot;男&quot;</span>, <span class="string">&quot;123@qq.com&quot;</span>));</span><br><span class="line">    System.out.println(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">11</span>:<span class="number">50</span>:<span class="number">15</span>,<span class="number">306</span> ==&gt;  Preparing: insert into t_user values(null,?,?,?,?,?)  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">11</span>:<span class="number">50</span>:<span class="number">15</span>,<span class="number">361</span> ==&gt; Parameters: 李四(String), <span class="number">123</span>(String), <span class="number">23</span>(Integer), 男(String), <span class="number">123</span>@qq.com(String)  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">11</span>:<span class="number">50</span>:<span class="number">15</span>,<span class="number">979</span> &lt;==    Updates: <span class="number">1</span>  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">1</span></span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/yagote/blog-image/master/202310021103664.png" alt="image-20220507115101617" style="zoom: 80%;" />

<h5 id="5、使用-Param标识参数"><a href="#5、使用-Param标识参数" class="headerlink" title="==5、使用@Param标识参数=="></a>==5、使用@Param标识参数==</h5><p>可以通过@Param注解标识mapper接口中的方法参数，此时，会将这些参数放在map集合中，<strong>以@Param注解的value属性值为键，以参数为值；以param1,param2…为键，以参数为值</strong>；只需要通过<code>$&#123;&#125;</code>和<code>#&#123;&#125;</code>访问map集合的键就可以获取相对应的值，注意${}需要手动加单引号。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 验证登录（使用<span class="doctag">@Param</span>）   //5、使用<span class="doctag">@Param</span>标识参数</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//@Param 注解通常用于标识方法参数对应的实际参数名称，从而在方法调用时可以正确映射参数。</span></span><br><span class="line"><span class="function">User <span class="title">checkLoginByParam</span><span class="params">(<span class="meta">@Param(&quot;username&quot;)</span> String username, <span class="meta">@Param(&quot;password&quot;)</span> String password)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--5、使用@Param标识参数User checkLoginByParam(@Param(&quot;username&quot;) String username, @Param(&quot;password&quot;) String password);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;checkLoginByParam&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    select * from t_user where username = #&#123;username&#125; and password = #&#123;password&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>   <span class="comment">//5、使用@Param标识参数</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCheckLoginByParam</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = SqlSessionUtils.getSqlSession();</span><br><span class="line">    ParameterMapper mapper = sqlSession.getMapper(ParameterMapper.class);</span><br><span class="line">    User user = mapper.checkLoginByParam(<span class="string">&quot;admin&quot;</span>, <span class="string">&quot;123456&quot;</span>);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">11</span>:<span class="number">52</span>:<span class="number">25</span>,<span class="number">568</span> ==&gt;  Preparing: select * from t_user where username = ? and password = ?  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">11</span>:<span class="number">52</span>:<span class="number">25</span>,<span class="number">631</span> ==&gt; Parameters: admin(String), <span class="number">123456</span>(String)  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">11</span>:<span class="number">52</span>:<span class="number">25</span>,<span class="number">890</span> &lt;==      Total: <span class="number">1</span>  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">User</span>&#123;id=<span class="number">1</span>, username=&#x27;admin&#x27;, password=&#x27;<span class="number">123456</span>&#x27;, age=<span class="number">23</span>, sex=&#x27;男&#x27;, email=&#x27;<span class="number">12345</span>@qq.com&#x27;&#125;</span><br></pre></td></tr></table></figure>



<h4 id="六、MyBatis的各种查询功能"><a href="#六、MyBatis的各种查询功能" class="headerlink" title="六、MyBatis的各种查询功能"></a>六、MyBatis的各种查询功能</h4><p>【代码在mybatis02】</p>
<h5 id="1、查询一个实体类对象"><a href="#1、查询一个实体类对象" class="headerlink" title="1、查询一个实体类对象"></a>1、查询一个实体类对象</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据id查询用户信息   //1、查询一个实体类对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">List&lt;User&gt; <span class="title">getUserById</span><span class="params">(<span class="meta">@Param(&quot;id&quot;)</span> Integer id)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--1、查询一个实体类对象User getUserById(@Param(&quot;id&quot;) Integer id);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    select * from t_user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>   <span class="comment">//1、查询一个实体类对象</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetUserById</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = SqlSessionUtils.getSqlSession();</span><br><span class="line">    SelectMapper mapper = sqlSession.getMapper(SelectMapper.class);</span><br><span class="line">    System.out.println(mapper.getUserById(<span class="number">3</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">12</span>:<span class="number">07</span>:<span class="number">43</span>,<span class="number">574</span> ==&gt;  Preparing: select * from t_user where id = ?  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">12</span>:<span class="number">07</span>:<span class="number">43</span>,<span class="number">643</span> ==&gt; Parameters: <span class="number">3</span>(Integer)  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">12</span>:<span class="number">07</span>:<span class="number">43</span>,<span class="number">802</span> &lt;==      Total: <span class="number">1</span>  (BaseJdbcLogger.java:<span class="number">137</span>) <span class="meta"></span></span><br><span class="line"><span class="meta">[User&#123;id=3, username=&#x27;李四&#x27;, password=&#x27;123&#x27;, age=23, sex=&#x27;男&#x27;, email=&#x27;123@qq.com&#x27;&#125;]</span></span><br></pre></td></tr></table></figure>

<h5 id="2、查询一个list集合"><a href="#2、查询一个list集合" class="headerlink" title="2、查询一个list集合"></a>2、查询一个list集合</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询所有的用户信息    //2、查询一个list集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">List&lt;User&gt; <span class="title">getAllUser</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--//2、查询一个list集合List&lt;User&gt; getAllUser();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getAllUser&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    select * from t_user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>   <span class="comment">//2、查询一个list集合</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetAllUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = SqlSessionUtils.getSqlSession();</span><br><span class="line">    SelectMapper mapper = sqlSession.getMapper(SelectMapper.class);</span><br><span class="line">    System.out.println(mapper.getAllUser());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">DEBUG</span> 05-07 12:09:41,676 ==&gt;  Preparing: select * <span class="keyword">from</span> t_user  (BaseJdbcLogger.java:137) </span><br><span class="line"><span class="builtin-name">DEBUG</span> 05-07 12:09:41,726 ==&gt; Parameters:   (BaseJdbcLogger.java:137) </span><br><span class="line"><span class="builtin-name">DEBUG</span> 05-07 12:09:41,842 &lt;==      Total: 2  (BaseJdbcLogger.java:137) </span><br><span class="line">[User&#123;<span class="attribute">id</span>=1, <span class="attribute">username</span>=<span class="string">&#x27;admin&#x27;</span>, <span class="attribute">password</span>=<span class="string">&#x27;123456&#x27;</span>, <span class="attribute">age</span>=23, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;12345@qq.com&#x27;</span>&#125;, User&#123;<span class="attribute">id</span>=3, <span class="attribute">username</span>=<span class="string">&#x27;李四&#x27;</span>, <span class="attribute">password</span>=<span class="string">&#x27;123&#x27;</span>, <span class="attribute">age</span>=23, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;123@qq.com&#x27;</span>&#125;]</span><br></pre></td></tr></table></figure>

<h5 id="3、查询单个数据"><a href="#3、查询单个数据" class="headerlink" title="3、查询单个数据"></a>3、查询单个数据</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询用户信息的总记录数  //3、查询单个数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">Integer <span class="title">getCount</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--//3、查询单个数据Integer getCount();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getCount&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;_int&quot;</span>&gt;</span></span><br><span class="line">    select count(*) from t_user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>   <span class="comment">//3、查询单个数据(这里查询总的记录数)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetCount</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = SqlSessionUtils.getSqlSession();</span><br><span class="line">    SelectMapper mapper = sqlSession.getMapper(SelectMapper.class);</span><br><span class="line">    System.out.println(mapper.getCount());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">12</span>:<span class="number">10</span>:<span class="number">55</span>,<span class="number">370</span> ==&gt;  Preparing: select count(*) from t_user  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">12</span>:<span class="number">10</span>:<span class="number">55</span>,<span class="number">443</span> ==&gt; Parameters:   (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">12</span>:<span class="number">10</span>:<span class="number">55</span>,<span class="number">700</span> &lt;==      Total: <span class="number">1</span>  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">2</span></span><br></pre></td></tr></table></figure>

<p>数据库中确实只有两条记录。</p>
<img src="https://raw.githubusercontent.com/yagote/blog-image/master/202310021103665.png" alt="image-20220507121155391" style="zoom:80%;" />

<h5 id="4、查询一条数据为map集合"><a href="#4、查询一条数据为map集合" class="headerlink" title="4、查询一条数据为map集合"></a>4、查询一条数据为map集合</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据id查询用户信息为一个map集合   //4、查询一条数据为map集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">Map&lt;String, Object&gt; <span class="title">getUserByIdToMap</span><span class="params">(<span class="meta">@Param(&quot;id&quot;)</span> Integer id)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--//4、查询一条数据为map集合Map&lt;String, Object&gt; getUserByIdToMap(@Param(&quot;id&quot;) Integer id);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserByIdToMap&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">    select * from t_user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>   <span class="comment">//4、查询一条数据为map集合</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetUserByIdToMap</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = SqlSessionUtils.getSqlSession();</span><br><span class="line">    SelectMapper mapper = sqlSession.getMapper(SelectMapper.class);</span><br><span class="line">    System.out.println(mapper.getUserByIdToMap(<span class="number">3</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">DEBUG</span> 05-07 12:13:10,313 ==&gt;  Preparing: select * <span class="keyword">from</span> t_user where id = ?  (BaseJdbcLogger.java:137) </span><br><span class="line"><span class="builtin-name">DEBUG</span> 05-07 12:13:10,370 ==&gt; Parameters: 3(Integer)  (BaseJdbcLogger.java:137) </span><br><span class="line"><span class="builtin-name">DEBUG</span> 05-07 12:13:10,746 &lt;==      Total: 1  (BaseJdbcLogger.java:137) </span><br><span class="line">&#123;<span class="attribute">password</span>=123, <span class="attribute">sex</span>=男, <span class="attribute">id</span>=3, <span class="attribute">age</span>=23, <span class="attribute">email</span>=123@qq.com, <span class="attribute">username</span>=李四&#125;</span><br></pre></td></tr></table></figure>

<h5 id="5、查询多条数据为map集合"><a href="#5、查询多条数据为map集合" class="headerlink" title="5、查询多条数据为map集合"></a>5、查询多条数据为map集合</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询所有用户信息为map集合   //5、查询多条数据为map集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//List&lt;Map&lt;String, Object&gt;&gt; getAllUserToMap();</span></span><br><span class="line"><span class="meta">@MapKey(&quot;id&quot;)</span></span><br><span class="line"><span class="function">Map&lt;String, Object&gt; <span class="title">getAllUserToMap</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--//5、查询多条数据为map集合Map&lt;String, Object&gt; getAllUserToMap();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getAllUserToMap&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">    select * from t_user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>   <span class="comment">//5、查询多条数据为map集合</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetAllUserToMap</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = SqlSessionUtils.getSqlSession();</span><br><span class="line">    SelectMapper mapper = sqlSession.getMapper(SelectMapper.class);</span><br><span class="line">    System.out.println(mapper.getAllUserToMap());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出的结果是集合</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">DEBUG</span> 05-07 12:14:26,721 ==&gt;  Preparing: select * <span class="keyword">from</span> t_user  (BaseJdbcLogger.java:137) </span><br><span class="line"><span class="builtin-name">DEBUG</span> 05-07 12:14:26,782 ==&gt; Parameters:   (BaseJdbcLogger.java:137) </span><br><span class="line"><span class="builtin-name">DEBUG</span> 05-07 12:14:26,979 &lt;==      Total: 2  (BaseJdbcLogger.java:137) </span><br><span class="line">&#123;1=&#123;<span class="attribute">password</span>=123456, <span class="attribute">sex</span>=男, <span class="attribute">id</span>=1, <span class="attribute">age</span>=23, <span class="attribute">email</span>=12345@qq.com, <span class="attribute">username</span>=admin&#125;, 3=&#123;<span class="attribute">password</span>=123, <span class="attribute">sex</span>=男, <span class="attribute">id</span>=3, <span class="attribute">age</span>=23, <span class="attribute">email</span>=123@qq.com, <span class="attribute">username</span>=李四&#125;&#125;</span><br></pre></td></tr></table></figure>



<h4 id="七、特殊SQL的执行"><a href="#七、特殊SQL的执行" class="headerlink" title="七、特殊SQL的执行"></a>七、特殊SQL的执行</h4><p>【代码在mybatis02】</p>
<h5 id="1、模糊查询"><a href="#1、模糊查询" class="headerlink" title="1、模糊查询"></a>1、模糊查询</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据用户名模糊查询用户信息    1、模糊查询</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">List&lt;User&gt; <span class="title">getUserByLike</span><span class="params">(<span class="meta">@Param(&quot;username&quot;)</span> String username)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--1、模糊查询 List&lt;User&gt; getUserByLike(@Param(&quot;username&quot;) String username);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserByLike&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--select * from t_user where username like &#x27;%$&#123;username&#125;%&#x27;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--select * from t_user where username like concat(&#x27;%&#x27;,#&#123;username&#125;,&#x27;%&#x27;)--&gt;</span></span><br><span class="line">    select * from t_user where username like &quot;%&quot;#&#123;username&#125;&quot;%&quot;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>   <span class="comment">//1、模糊查询</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetUserByLike</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = SqlSessionUtils.getSqlSession();</span><br><span class="line">    SQLMapper mapper = sqlSession.getMapper(SQLMapper.class);</span><br><span class="line">    List&lt;User&gt; list = mapper.getUserByLike(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">    System.out.println(list);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">12</span>:<span class="number">28</span>:<span class="number">10</span>,<span class="number">379</span> ==&gt;  Preparing: select * from t_user where username like <span class="string">&quot;%&quot;</span>?<span class="string">&quot;%&quot;</span>  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">12</span>:<span class="number">28</span>:<span class="number">10</span>,<span class="number">428</span> ==&gt; Parameters: a(String)  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">12</span>:<span class="number">28</span>:<span class="number">10</span>,<span class="number">613</span> &lt;==      Total: <span class="number">1</span>  (BaseJdbcLogger.java:<span class="number">137</span>) <span class="meta"></span></span><br><span class="line"><span class="meta">[User&#123;id=1, username=&#x27;admin&#x27;, password=&#x27;123456&#x27;, age=23, sex=&#x27;男&#x27;, email=&#x27;12345@qq.com&#x27;&#125;]</span></span><br></pre></td></tr></table></figure>

<h5 id="2、批量删除"><a href="#2、批量删除" class="headerlink" title="2、批量删除"></a>2、批量删除</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 批量删除     2、批量删除</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">deleteMore</span><span class="params">(<span class="meta">@Param(&quot;ids&quot;)</span> String ids)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--2、批量删除 int deleteMore(@Param(&quot;ids&quot;) String ids);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteMore&quot;</span>&gt;</span></span><br><span class="line">    delete from t_user where id in ($&#123;ids&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>  <span class="comment">//2、批量删除</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteMore</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = SqlSessionUtils.getSqlSession();</span><br><span class="line">    SQLMapper mapper = sqlSession.getMapper(SQLMapper.class);</span><br><span class="line">    <span class="keyword">int</span> result = mapper.deleteMore(<span class="string">&quot;4,2,3&quot;</span>);</span><br><span class="line">    System.out.println(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>数据库中原先的数据</p>
<img src="https://raw.githubusercontent.com/yagote/blog-image/master/202310021103667.png" alt="image-20220507122946539" style="zoom:80%;" />

<p>执行批量删除操作</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">12</span>:<span class="number">30</span>:<span class="number">10</span>,<span class="number">335</span> ==&gt;  Preparing: delete from t_user where id in (<span class="number">4</span>,<span class="number">2</span>,<span class="number">3</span>)  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">12</span>:<span class="number">30</span>:<span class="number">10</span>,<span class="number">394</span> ==&gt; Parameters:   (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">12</span>:<span class="number">30</span>:<span class="number">10</span>,<span class="number">677</span> &lt;==    Updates: <span class="number">3</span>  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">3</span></span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/yagote/blog-image/master/202310021103668.png" alt="image-20220507123042954" style="zoom:80%;" />

<h5 id="3、动态设置表名"><a href="#3、动态设置表名" class="headerlink" title="3、动态设置表名"></a>3、动态设置表名</h5><p>不知道这个功能是什么意思，有什么用？</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询指定表中的数据    3、动态设置表名</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">List&lt;User&gt; <span class="title">getUserByTableName</span><span class="params">(<span class="meta">@Param(&quot;tableName&quot;)</span> String tableName)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--3、动态设置表名 List&lt;User&gt; getUserByTableName(@Param(&quot;tableName&quot;) String tableName);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserByTableName&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    select * from $&#123;tableName&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>   <span class="comment">//3、动态设置表名</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetUserByTableName</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = SqlSessionUtils.getSqlSession();</span><br><span class="line">    SQLMapper mapper = sqlSession.getMapper(SQLMapper.class);</span><br><span class="line">    List&lt;User&gt; list = mapper.getUserByTableName(<span class="string">&quot;t_user&quot;</span>);</span><br><span class="line">    System.out.println(list);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">12</span>:<span class="number">32</span>:<span class="number">03</span>,<span class="number">793</span> ==&gt;  Preparing: select * from t_user  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">12</span>:<span class="number">32</span>:<span class="number">03</span>,<span class="number">849</span> ==&gt; Parameters:   (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">12</span>:<span class="number">32</span>:<span class="number">03</span>,<span class="number">944</span> &lt;==      Total: <span class="number">1</span>  (BaseJdbcLogger.java:<span class="number">137</span>) <span class="meta"></span></span><br><span class="line"><span class="meta">[User&#123;id=1, username=&#x27;admin&#x27;, password=&#x27;123456&#x27;, age=23, sex=&#x27;男&#x27;, email=&#x27;12345@qq.com&#x27;&#125;]</span></span><br></pre></td></tr></table></figure>



<h5 id="4、添加功能获取自增的主键"><a href="#4、添加功能获取自增的主键" class="headerlink" title="4、添加功能获取自增的主键"></a>4、添加功能获取自增的主键</h5><p>不知道这个功能是什么意思，有什么用？</p>
<blockquote>
<p>使用的例子：</p>
<p>t_clazz(clazz_id,clazz_name)</p>
<p>t_student(student_id,student_name,clazz_id)</p>
<p>1、添加班级信息</p>
<p>2、获取新添加的班级的id</p>
<p>3、为班级分配学生，即将某学的班级id修改为新添加的班级的id</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 添加用户信息   4、添加功能获取自增的主键</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insertUser</span><span class="params">(User user)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">4、添加功能获取自增的主键</span></span><br><span class="line"><span class="comment">    void insertUser(User user);</span></span><br><span class="line"><span class="comment">    useGeneratedKeys:设置当前标签中的sql使用了自增的主键</span></span><br><span class="line"><span class="comment">    keyProperty:将自增的主键的值赋值给传输到映射文件中参数的某个属性</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertUser&quot;</span> <span class="attr">useGeneratedKeys</span>=<span class="string">&quot;true&quot;</span> <span class="attr">keyProperty</span>=<span class="string">&quot;id&quot;</span>&gt;</span></span><br><span class="line">    insert into t_user values(null,#&#123;username&#125;,#&#123;password&#125;,#&#123;age&#125;,#&#123;sex&#125;,#&#123;email&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>   <span class="comment">//4、添加功能获取自增的主键</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsertUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = SqlSessionUtils.getSqlSession();</span><br><span class="line">    SQLMapper mapper = sqlSession.getMapper(SQLMapper.class);</span><br><span class="line">    User user = <span class="keyword">new</span> User(<span class="keyword">null</span>, <span class="string">&quot;王五&quot;</span>, <span class="string">&quot;123&quot;</span>, <span class="number">23</span>, <span class="string">&quot;男&quot;</span>, <span class="string">&quot;123@163.com&quot;</span>);</span><br><span class="line">    mapper.insertUser(user);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">12</span>:<span class="number">35</span>:<span class="number">21</span>,<span class="number">738</span> ==&gt;  Preparing: insert into t_user values(null,?,?,?,?,?)  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">12</span>:<span class="number">35</span>:<span class="number">21</span>,<span class="number">790</span> ==&gt; Parameters: 王五(String), <span class="number">123</span>(String), <span class="number">23</span>(Integer), 男(String), <span class="number">123</span>@<span class="number">163</span>.com(String)  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">07</span> <span class="number">12</span>:<span class="number">35</span>:<span class="number">21</span>,<span class="number">953</span> &lt;==    Updates: <span class="number">1</span>  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">User</span>&#123;id=<span class="number">10</span>, username=&#x27;王五&#x27;, password=&#x27;<span class="number">123</span>&#x27;, age=<span class="number">23</span>, sex=&#x27;男&#x27;, email=&#x27;<span class="number">123</span>@<span class="number">163</span>.com&#x27;&#125;</span><br></pre></td></tr></table></figure>

<p>数据库中多了一条记录</p>
<img src="https://raw.githubusercontent.com/yagote/blog-image/master/202310021103669.png" alt="image-20220507123610899" style="zoom:80%;" />





<h4 id="八、自定义映射resultMap"><a href="#八、自定义映射resultMap" class="headerlink" title="八、自定义映射resultMap"></a>八、自定义映射resultMap</h4><p>【代码在mybatis03】</p>
<h5 id="1、字段名和属性名不一致"><a href="#1、字段名和属性名不一致" class="headerlink" title="1、字段名和属性名不一致"></a>1、字段名和属性名不一致</h5><p>【代码在EmpMapper.xml、ResultMapTest.java】</p>
<p>所谓的字段名和属性名不一致指的是代码中实体类的属性名称和数据库中的表格的列名称不一致，查询时就不会显示出结果，需要处理，但不能通过更改名称一致处理，这样是不方便的。</p>
<p>解决方法：</p>
<h6 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h6><p><strong>为字段起别名，保持和属性名的一致</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from t_emp		-- 原本的查询语句，没有处理字段名</span><br><span class="line">select eid,emp_name empName,age,sex,email from t_emp		-- 处理字段名，把查询到数据库中的列名emp_name设置别名empName</span><br></pre></td></tr></table></figure>

<h6 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h6><p><strong>设置全局配置，将_自动映射为驼峰</strong></p>
<p>这个需要再mybatis-config.xml中进行配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;mapUnderscoreToCamelCase&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span>		//这个的意思就是让MyBatis开启驼峰命名，如将emp_name修改为empName</span><br></pre></td></tr></table></figure>

<h6 id="方法三"><a href="#方法三" class="headerlink" title="方法三"></a>方法三</h6><p><strong>通过resultMap设置自定义的映射关系</strong></p>
<p>这个配置在Mapper的xml文件中。<code>property=&quot;empName&quot;</code> 表示 Java 对象中的属性名称是 <code>empName</code>，<code>column=&quot;emp_name&quot;</code> 表示 SQL 查询结果中的列名称是 <code>emp_name</code>，两者之间建立了映射关系。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--这个配置在DeptMapper.xml中--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;empResultMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;eid&quot;</span> <span class="attr">column</span>=<span class="string">&quot;eid&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;empName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;emp_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;age&quot;</span> <span class="attr">column</span>=<span class="string">&quot;age&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sex&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--List&lt;Emp&gt; getAllEmp();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getAllEmp&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;empResultMap&quot;</span>&gt;</span></span><br><span class="line">    select * from t_emp</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">resultMap：设置自定义映射关系</span><br><span class="line"><span class="built_in">id</span>：唯一标识，不能重复</span><br><span class="line"><span class="built_in">type</span>：设置映射关系中的实体类类型</span><br><span class="line">子标签<span class="built_in">id</span>：设置主键的映射关系</span><br><span class="line">result：设置普通字段的映射关系</span><br><span class="line"><span class="built_in">property</span>：设置映射关系中的属性名，必须是<span class="built_in">type</span>属性所设置的实体类类型中的属性名</span><br><span class="line">column：设置映射关系中的字段名，必须是sql语句查询出的字段名</span><br></pre></td></tr></table></figure>

<p>这时可以先把方法二中的配置setting注释掉再运行看看效果</p>
<p>以上3种方法，控制台查询输出的结果均是</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Emp&#123;<span class="attribute">eid</span>=1, <span class="attribute">empName</span>=<span class="string">&#x27;张三&#x27;</span>, <span class="attribute">age</span>=20, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;123@qq.com&#x27;</span>, <span class="attribute">dept</span>=<span class="literal">null</span>&#125;</span><br><span class="line">Emp&#123;<span class="attribute">eid</span>=2, <span class="attribute">empName</span>=<span class="string">&#x27;李四&#x27;</span>, <span class="attribute">age</span>=21, <span class="attribute">sex</span>=<span class="string">&#x27;女&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;234@qq.com&#x27;</span>, <span class="attribute">dept</span>=<span class="literal">null</span>&#125;</span><br><span class="line">Emp&#123;<span class="attribute">eid</span>=3, <span class="attribute">empName</span>=<span class="string">&#x27;王五&#x27;</span>, <span class="attribute">age</span>=22, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;345@qq.com&#x27;</span>, <span class="attribute">dept</span>=<span class="literal">null</span>&#125;</span><br><span class="line">Emp&#123;<span class="attribute">eid</span>=4, <span class="attribute">empName</span>=<span class="string">&#x27;赵六&#x27;</span>, <span class="attribute">age</span>=23, <span class="attribute">sex</span>=<span class="string">&#x27;女&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;456@qq.com&#x27;</span>, <span class="attribute">dept</span>=<span class="literal">null</span>&#125;</span><br><span class="line">Emp&#123;<span class="attribute">eid</span>=5, <span class="attribute">empName</span>=<span class="string">&#x27;田七&#x27;</span>, <span class="attribute">age</span>=24, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;567@qq.com&#x27;</span>, <span class="attribute">dept</span>=<span class="literal">null</span>&#125;</span><br></pre></td></tr></table></figure>

<p>实际数据库中的数据</p>
<img src="https://raw.githubusercontent.com/yagote/blog-image/master/202310021103670.png" alt="image-20220516153712148" style="zoom:80%;" />





<h5 id="2、多对一映射处理"><a href="#2、多对一映射处理" class="headerlink" title="2、多对一映射处理"></a>2、多对一映射处理</h5><p>例子：查询员工信息以及员工所对应的部门信息</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 查询员工以及员工所对应的部门信息</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function">Emp <span class="title">getEmpAndDept</span><span class="params">(<span class="meta">@Param(&quot;eid&quot;)</span> Integer eid)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_emp <span class="keyword">left</span> <span class="keyword">join</span> t_dept <span class="keyword">on</span> t_emp.did <span class="operator">=</span> t_dept .did <span class="keyword">where</span> t_emp.eid <span class="operator">=</span><span class="number">1</span>;		<span class="comment">-- 这是实际在数据库中的操作。外连接查询，左连接查询</span></span><br></pre></td></tr></table></figure>



<h6 id="2-1-级联方式"><a href="#2-1-级联方式" class="headerlink" title="2.1 级联方式"></a>2.1 级联方式</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--处理多对一映射关系方式一：级联属性赋值--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;empAndDeptResultMapOne&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;eid&quot;</span> <span class="attr">column</span>=<span class="string">&quot;eid&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;empName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;emp_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;age&quot;</span> <span class="attr">column</span>=<span class="string">&quot;age&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sex&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;dept.did&quot;</span> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;dept.deptName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;dept_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpAndDept&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;empAndDeptResultMapOne&quot;</span>&gt;</span></span><br><span class="line">    select * from t_emp left join t_dept on t_emp.did = t_dept .did where t_emp.eid = #&#123;eid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetDeptAndEmp</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = SqlSessionUtils.getSqlSession();</span><br><span class="line">    DeptMapper mapper = sqlSession.getMapper(DeptMapper.class);</span><br><span class="line">    Dept dept = mapper.getDeptAndEmp(<span class="number">1</span>);</span><br><span class="line">    System.out.println(dept);</span><br><span class="line">&#125;	</span><br></pre></td></tr></table></figure>

<p>控制台输出</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Emp&#123;<span class="attribute">eid</span>=1, <span class="attribute">empName</span>=<span class="string">&#x27;张三&#x27;</span>, <span class="attribute">age</span>=20, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;123@qq.com&#x27;</span>, <span class="attribute">dept</span>=Dept&#123;<span class="attribute">did</span>=1, <span class="attribute">deptName</span>=<span class="string">&#x27;A&#x27;</span>, <span class="attribute">emps</span>=<span class="literal">null</span>&#125;&#125;</span><br></pre></td></tr></table></figure>



<h6 id="2-2-association方式"><a href="#2-2-association方式" class="headerlink" title="2.2 association方式"></a>2.2 association方式</h6><p>association：处理多对一的映射关系<br>property：需要处理多对的映射关系的属性名<br>javaType：该属性的类型</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--处理多对一映射关系方式二：association--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;empAndDeptResultMapTwo&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;eid&quot;</span> <span class="attr">column</span>=<span class="string">&quot;eid&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;empName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;emp_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;age&quot;</span> <span class="attr">column</span>=<span class="string">&quot;age&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sex&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;dept&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;Dept&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;did&quot;</span> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;deptName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;dept_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpAndDept&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;empAndDeptResultMapTwo&quot;</span>&gt;</span></span><br><span class="line">    select * from t_emp left join t_dept on t_emp.did = t_dept .did where t_emp.eid = #&#123;eid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetDeptAndEmp</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = SqlSessionUtils.getSqlSession();</span><br><span class="line">    DeptMapper mapper = sqlSession.getMapper(DeptMapper.class);</span><br><span class="line">    Dept dept = mapper.getDeptAndEmp(<span class="number">1</span>);</span><br><span class="line">    System.out.println(dept);</span><br><span class="line">&#125;	</span><br></pre></td></tr></table></figure>

<p>控制台输出</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Emp&#123;<span class="attribute">eid</span>=1, <span class="attribute">empName</span>=<span class="string">&#x27;张三&#x27;</span>, <span class="attribute">age</span>=20, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;123@qq.com&#x27;</span>, <span class="attribute">dept</span>=Dept&#123;<span class="attribute">did</span>=1, <span class="attribute">deptName</span>=<span class="string">&#x27;A&#x27;</span>, <span class="attribute">emps</span>=<span class="literal">null</span>&#125;&#125;</span><br></pre></td></tr></table></figure>

<h6 id="2-3-分步查询"><a href="#2-3-分步查询" class="headerlink" title="2.3 分步查询"></a>2.3 分步查询</h6><p>==分步查询的优点：可以实现延迟加载，但是必须在核心配置文件中设置全局配置信息==</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--设置MyBatis的全局配置--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--开启延迟加载--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;lazyLoadingEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>分布查询可以处理多对一和一对多查询，是比较常用的。</strong></p>
<p>这里是多对一的分布查询，先查询t_dept表，再将查询到的结果赋给t_emp表进行查询。</p>
<p><code>DeptMapper.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过分步查询查询员工以及员工所对应的部门信息</span></span><br><span class="line"><span class="comment"> * 分步查询第二步：通过did查询员工所对应的部门</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">Dept <span class="title">getEmpAndDeptByStepTwo</span><span class="params">(<span class="meta">@Param(&quot;did&quot;)</span> Integer did)</span></span>;</span><br></pre></td></tr></table></figure>



<ul>
<li>property：表示 Java 对象中的属性名称，这个属性名称将会被映射到 SQL 查询结果中的某一列上</li>
<li>select：设置分步查询的sql的唯一标识（namespace.SQLId或mapper接口的全类名.方法名）</li>
<li>column：设置分布查询的条件</li>
<li>fetchType：当开启了全局的延迟加载之后，可通过此属性手动控制延迟加载的效果<br>fetchType=”lazy|eager”：lazy表示延迟加载，eager表示立即加载</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--设置MyBatis的全局配置--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--开启延迟加载--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;lazyLoadingEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;empAndDeptByStepResultMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;eid&quot;</span> <span class="attr">column</span>=<span class="string">&quot;eid&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;empName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;emp_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;age&quot;</span> <span class="attr">column</span>=<span class="string">&quot;age&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sex&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;dept&quot;</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">select</span>=<span class="string">&quot;com.ya.mybatis.mapper.DeptMapper.getEmpAndDeptByStepTwo&quot;</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">column</span>=<span class="string">&quot;did&quot;</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">fetchType</span>=<span class="string">&quot;eager&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Emp getEmpAndDeptByStepOne(@Param(&quot;eid&quot;) Integer eid);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpAndDeptByStepOne&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;empAndDeptByStepResultMap&quot;</span>&gt;</span></span><br><span class="line">    select * from t_emp where eid = #&#123;eid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>       <span class="comment">//多对一，分布查询，并设置了延时加载</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetEmpAndDeptByStep</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = SqlSessionUtils.getSqlSession();</span><br><span class="line">    EmpMapper mapper = sqlSession.getMapper(EmpMapper.class);</span><br><span class="line">    Emp emp = mapper.getEmpAndDeptByStepOne(<span class="number">3</span>);</span><br><span class="line">    System.out.println(emp.getEmpName());</span><br><span class="line">    System.out.println(<span class="string">&quot;++++++++++++下面是延时加载获取的数据++++++++++++++&quot;</span>);</span><br><span class="line">    System.out.println(emp.getDept());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">17:55:22.183 [main] <span class="builtin-name">DEBUG</span> org.apache.ibatis.datasource.pooled.PooledDataSource - Created<span class="built_in"> connection </span>196732636.</span><br><span class="line">17:55:22.200 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.EmpMapper.getEmpAndDeptByStepOne - ==&gt;  Preparing: select * <span class="keyword">from</span> t_emp where eid = ?</span><br><span class="line">17:55:22.254 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.EmpMapper.getEmpAndDeptByStepOne - ==&gt; Parameters: 3(Integer)</span><br><span class="line">17:55:22.444 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.DeptMapper.getEmpAndDeptByStepTwo - ====&gt;  Preparing: select * <span class="keyword">from</span> t_dept where did = ?</span><br><span class="line">17:55:22.444 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.DeptMapper.getEmpAndDeptByStepTwo - ====&gt; Parameters: 3(Integer)</span><br><span class="line">17:55:22.568 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.DeptMapper.getEmpAndDeptByStepTwo - &lt;====      Total: 1</span><br><span class="line">17:55:22.570 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.EmpMapper.getEmpAndDeptByStepOne - &lt;==      Total: 1</span><br><span class="line">王五</span><br><span class="line">++++++++++++下面是延时加载获取的数据++++++++++++++</span><br><span class="line">Dept&#123;<span class="attribute">did</span>=3, <span class="attribute">deptName</span>=<span class="string">&#x27;C&#x27;</span>, <span class="attribute">emps</span>=<span class="literal">null</span>&#125;</span><br></pre></td></tr></table></figure>





<h5 id="3、一对多映射处理"><a href="#3、一对多映射处理" class="headerlink" title="3、一对多映射处理"></a>3、一对多映射处理</h5><h6 id="3-1-collection"><a href="#3-1-collection" class="headerlink" title="3.1 collection"></a>3.1 collection</h6><p>collection：处理一对多的映射关系</p>
<p>ofType：表示该属性所对应的集合中存储数据的类型</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取部门以及部门中所有的员工信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">Dept <span class="title">getDeptAndEmp</span><span class="params">(<span class="meta">@Param(&quot;did&quot;)</span> Integer did)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;deptAndEmpResultMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Dept&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;did&quot;</span> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;deptName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;dept_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        collection：处理一对多的映射关系</span></span><br><span class="line"><span class="comment">        ofType：表示该属性所对应的集合中存储数据的类型</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;emps&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;eid&quot;</span> <span class="attr">column</span>=<span class="string">&quot;eid&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;empName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;emp_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;age&quot;</span> <span class="attr">column</span>=<span class="string">&quot;age&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sex&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Dept getDeptAndEmp(@Param(&quot;did&quot;) Integer did);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getDeptAndEmp&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;deptAndEmpResultMap&quot;</span>&gt;</span></span><br><span class="line">    select * from t_dept left join t_emp on t_dept.did = t_emp.did where t_dept.did = #&#123;did&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>   <span class="comment">//一对多，使用collection</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetDeptAndEmp</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = SqlSessionUtils.getSqlSession();</span><br><span class="line">    DeptMapper mapper = sqlSession.getMapper(DeptMapper.class);</span><br><span class="line">    Dept dept = mapper.getDeptAndEmp(<span class="number">1</span>);</span><br><span class="line">    System.out.println(dept);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">19:16:57.928 [main] <span class="builtin-name">DEBUG</span> org.apache.ibatis.datasource.pooled.PooledDataSource - Created<span class="built_in"> connection </span>196732636.</span><br><span class="line">19:16:57.929 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.DeptMapper.getDeptAndEmp - ==&gt;  Preparing: select * <span class="keyword">from</span> t_dept left join t_emp on t_dept.did = t_emp.did where t_dept.did = ?</span><br><span class="line">19:16:57.971 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.DeptMapper.getDeptAndEmp - ==&gt; Parameters: 1(Integer)</span><br><span class="line">19:16:58.124 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.DeptMapper.getDeptAndEmp - &lt;==      Total: 2</span><br><span class="line">Dept&#123;<span class="attribute">did</span>=1, <span class="attribute">deptName</span>=<span class="string">&#x27;A&#x27;</span>, emps=[Emp&#123;<span class="attribute">eid</span>=1, <span class="attribute">empName</span>=<span class="string">&#x27;张三&#x27;</span>, <span class="attribute">age</span>=20, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;123@qq.com&#x27;</span>, <span class="attribute">dept</span>=<span class="literal">null</span>&#125;, Emp&#123;<span class="attribute">eid</span>=4, <span class="attribute">empName</span>=<span class="string">&#x27;赵六&#x27;</span>, <span class="attribute">age</span>=23, <span class="attribute">sex</span>=<span class="string">&#x27;女&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;456@qq.com&#x27;</span>, <span class="attribute">dept</span>=<span class="literal">null</span>&#125;]&#125;</span><br></pre></td></tr></table></figure>



<h6 id="3-2-分步查询"><a href="#3-2-分步查询" class="headerlink" title="3.2 分步查询"></a>3.2 分步查询</h6><p>DeptMapper.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过分步查询查询部门以及部门中所有的员工信息</span></span><br><span class="line"><span class="comment"> * 分步查询第一步：查询部门信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">Dept <span class="title">getDeptAndEmpByStepOne</span><span class="params">(<span class="meta">@Param(&quot;did&quot;)</span> Integer did)</span></span>;</span><br></pre></td></tr></table></figure>

<p>EmptMapper.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过分步查询查询部门以及部门中所有的员工信息</span></span><br><span class="line"><span class="comment"> * 分步查询第二步：根据did查询员工信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">List&lt;Emp&gt; <span class="title">getDeptAndEmpByStepTwo</span><span class="params">(<span class="meta">@Param(&quot;did&quot;)</span> Integer did)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;deptAndEmpByStepResultMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Dept&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;did&quot;</span> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;deptName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;dept_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;emps&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">select</span>=<span class="string">&quot;com.ya.mybatis.mapper.EmpMapper.getDeptAndEmpByStepTwo&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">column</span>=<span class="string">&quot;did&quot;</span> <span class="attr">fetchType</span>=<span class="string">&quot;eager&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Dept getDeptAndEmpByStepOne(@Param(&quot;did&quot;) Integer did);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getDeptAndEmpByStepOne&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;deptAndEmpByStepResultMap&quot;</span>&gt;</span></span><br><span class="line">    select * from t_dept where did = #&#123;did&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>   <span class="comment">//一对多，使用分布查询</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetDeptAndEmpByStep</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = SqlSessionUtils.getSqlSession();</span><br><span class="line">    DeptMapper mapper = sqlSession.getMapper(DeptMapper.class);</span><br><span class="line">    Dept dept = mapper.getDeptAndEmpByStepOne(<span class="number">1</span>);</span><br><span class="line">    <span class="comment">// System.out.println(dept.getDeptName());     //这里使用了延时加载</span></span><br><span class="line">    System.out.println(dept);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">19:30:11.410 [main] <span class="builtin-name">DEBUG</span> org.apache.ibatis.datasource.pooled.PooledDataSource - Created<span class="built_in"> connection </span>1414967210.</span><br><span class="line">19:30:11.410 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.DeptMapper.getDeptAndEmpByStepOne - ==&gt;  Preparing: select * <span class="keyword">from</span> t_dept where did = ?</span><br><span class="line">19:30:11.473 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.DeptMapper.getDeptAndEmpByStepOne - ==&gt; Parameters: 1(Integer)</span><br><span class="line">19:30:11.624 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.EmpMapper.getDeptAndEmpByStepTwo - ====&gt;  Preparing: select * <span class="keyword">from</span> t_emp where did = ?</span><br><span class="line">19:30:11.625 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.EmpMapper.getDeptAndEmpByStepTwo - ====&gt; Parameters: 1(Integer)</span><br><span class="line">19:30:11.701 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.EmpMapper.getDeptAndEmpByStepTwo - &lt;====      Total: 2</span><br><span class="line">19:30:11.703 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.DeptMapper.getDeptAndEmpByStepOne - &lt;==      Total: 1</span><br><span class="line">Dept&#123;<span class="attribute">did</span>=1, <span class="attribute">deptName</span>=<span class="string">&#x27;A&#x27;</span>, emps=[Emp&#123;<span class="attribute">eid</span>=1, <span class="attribute">empName</span>=<span class="string">&#x27;张三&#x27;</span>, <span class="attribute">age</span>=20, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;123@qq.com&#x27;</span>, <span class="attribute">dept</span>=<span class="literal">null</span>&#125;, Emp&#123;<span class="attribute">eid</span>=4, <span class="attribute">empName</span>=<span class="string">&#x27;赵六&#x27;</span>, <span class="attribute">age</span>=23, <span class="attribute">sex</span>=<span class="string">&#x27;女&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;456@qq.com&#x27;</span>, <span class="attribute">dept</span>=<span class="literal">null</span>&#125;]&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>分步查询的优点：可以实现延迟加载，但是必须在核心配置文件中设置全局配置信息：<br><code>lazyLoadingEnabled</code>：延迟加载的全局开关。当开启时，所有关联对象都会延迟加载；<br><code>aggressiveLazyLoading</code>：当开启时，任何方法的调用都会加载该对象的所有属性。 否则，每个属性会按需加载；</p>
<p>此时就可以实现按需加载，获取的数据是什么，就只会执行相应的sql。此时可通过association和collection中的fetchType属性设置当前的分步查询是否使用延迟加载，<code>fetchType</code>=”lazy(延迟加载) | <code>eager</code>(立即加载)”。</p>
</blockquote>
<h4 id="九、动态SQL"><a href="#九、动态SQL" class="headerlink" title="九、动态SQL"></a>九、动态SQL</h4><p>使用动态SQL主要是为了方便SQL语句的拼接。动态拼接SQL语句。</p>
<p>【代码在mybatis03】</p>
<h5 id="1、if"><a href="#1、if" class="headerlink" title="1、if"></a>1、if</h5><p>多条件查询。根据标签中 test属性所对应的表达式决定标签中的内容是否需要拼接到SQL中。 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 多条件查询</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">List&lt;Emp&gt; <span class="title">getEmpByCondition</span><span class="params">(Emp emp)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpByConditionOne&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line">    select * from t_emp where 1=1</span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;empName != null and empName != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">        emp_name = #&#123;empName&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;age != null and age != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">        and age = #&#123;age&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;sex != null and sex != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">        and sex = #&#123;sex&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;email != null and email != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">        and email = #&#123;email&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetEmpByCondition</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = SqlSessionUtils.getSqlSession();</span><br><span class="line">    DynamicSQLMapper mapper = sqlSession.getMapper(DynamicSQLMapper.class);</span><br><span class="line">    List&lt;Emp&gt; list = mapper.getEmpByCondition(<span class="keyword">new</span> Emp(<span class="keyword">null</span>, <span class="string">&quot;&quot;</span>, <span class="keyword">null</span>, <span class="string">&quot;&quot;</span>, <span class="keyword">null</span>));</span><br><span class="line">    System.out.println(list);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Emp&#123;<span class="attribute">eid</span>=1, <span class="attribute">empName</span>=<span class="string">&#x27;张三&#x27;</span>, <span class="attribute">age</span>=20, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;123@qq.com&#x27;</span>, <span class="attribute">dept</span>=<span class="literal">null</span>&#125;, Emp&#123;<span class="attribute">eid</span>=2, <span class="attribute">empName</span>=<span class="string">&#x27;李四&#x27;</span>, <span class="attribute">age</span>=21, <span class="attribute">sex</span>=<span class="string">&#x27;女&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;234@qq.com&#x27;</span>, <span class="attribute">dept</span>=<span class="literal">null</span>&#125;, Emp&#123;<span class="attribute">eid</span>=3, <span class="attribute">empName</span>=<span class="string">&#x27;王五&#x27;</span>, <span class="attribute">age</span>=22, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;345@qq.com&#x27;</span>, <span class="attribute">dept</span>=<span class="literal">null</span>&#125;, Emp&#123;<span class="attribute">eid</span>=4, <span class="attribute">empName</span>=<span class="string">&#x27;赵六&#x27;</span>, <span class="attribute">age</span>=23, <span class="attribute">sex</span>=<span class="string">&#x27;女&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;456@qq.com&#x27;</span>, <span class="attribute">dept</span>=<span class="literal">null</span>&#125;, Emp&#123;<span class="attribute">eid</span>=5, <span class="attribute">empName</span>=<span class="string">&#x27;田七&#x27;</span>, <span class="attribute">age</span>=24, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;567@qq.com&#x27;</span>, <span class="attribute">dept</span>=<span class="literal">null</span>&#125;]</span><br></pre></td></tr></table></figure>



<h5 id="2、where"><a href="#2、where" class="headerlink" title="2、where"></a>2、where</h5><p>动态设置，若之前的条件不满足，可以把<strong>前面</strong>SQL语句拼接的and或or去掉，后面的去不掉。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpByConditionTwo&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line">    select * from t_emp</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;empName != null and empName != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">            emp_name = #&#123;empName&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;age != null and age != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">            and age = #&#123;age&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;sex != null and sex != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">            or sex = #&#123;sex&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;email != null and email != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">            and email = #&#123;email&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h5 id="3、trim"><a href="#3、trim" class="headerlink" title="3、trim"></a>3、trim</h5><p>若标签中有内容时：<br>prefix|suffix：将trim标签中内容前面或后面添加指定内容；suffixOverrides|prefixOverrides：将trim标签中内容前面或后面去掉指定内容</p>
<p>若标签中没有内容时，trim标签也没有任何效果</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpByCondition&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line">    select <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;empColumns&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">include</span>&gt;</span> from t_emp</span><br><span class="line">    <span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">&quot;where&quot;</span> <span class="attr">suffixOverrides</span>=<span class="string">&quot;and|or&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;empName != null and empName != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">            emp_name = #&#123;empName&#125; and</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;age != null and age != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">            age = #&#123;age&#125; or</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;sex != null and sex != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">            sex = #&#123;sex&#125; and</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;email != null and email != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">            email = #&#123;email&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="4、choose、when、otherwise"><a href="#4、choose、when、otherwise" class="headerlink" title="4、choose、when、otherwise"></a>4、choose、when、otherwise</h5><p>相当于if…else if…else</p>
<p>when至少要有一个，otherwise最多只能有一个</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试choose、when、otherwise</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">List&lt;Emp&gt; <span class="title">getEmpByChoose</span><span class="params">(Emp emp)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--List&lt;Emp&gt; getEmpByChoose(Emp emp);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpByChoose&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line">    select * from t_emp</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">choose</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;empName != null and empName != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">                emp_name = #&#123;empName&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;age != null and age != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">                age = #&#123;age&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;sex != null and sex != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">                sex = #&#123;sex&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;email != null and email != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">                email = #&#123;email&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">otherwise</span>&gt;</span></span><br><span class="line">                did = 1</span><br><span class="line">            <span class="tag">&lt;/<span class="name">otherwise</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetEmpByChoose</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = SqlSessionUtils.getSqlSession();</span><br><span class="line">    DynamicSQLMapper mapper = sqlSession.getMapper(DynamicSQLMapper.class);</span><br><span class="line">    List&lt;Emp&gt; list = mapper.getEmpByChoose(<span class="keyword">new</span> Emp(<span class="keyword">null</span>, <span class="string">&quot;&quot;</span>, <span class="keyword">null</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>));</span><br><span class="line">    System.out.println(list);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Emp&#123;<span class="attribute">eid</span>=1, <span class="attribute">empName</span>=<span class="string">&#x27;张三&#x27;</span>, <span class="attribute">age</span>=20, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;123@qq.com&#x27;</span>, <span class="attribute">dept</span>=<span class="literal">null</span>&#125;, Emp&#123;<span class="attribute">eid</span>=4, <span class="attribute">empName</span>=<span class="string">&#x27;赵六&#x27;</span>, <span class="attribute">age</span>=23, <span class="attribute">sex</span>=<span class="string">&#x27;女&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;456@qq.com&#x27;</span>, <span class="attribute">dept</span>=<span class="literal">null</span>&#125;]</span><br></pre></td></tr></table></figure>

<h5 id="5、foreach"><a href="#5、foreach" class="headerlink" title="5、foreach"></a>5、foreach</h5><p>collection：设置需要循环的数组或集合</p>
<p>item：表示数组或集合中的每一个数据</p>
<p>separator：循环体之间的分割符</p>
<p>open：foreach标签所循环的所有内容的开始符</p>
<p>close：foreach标签所循环的所有内容的结束符</p>
<h6 id="5-1-通过数组实现批量删除"><a href="#5-1-通过数组实现批量删除" class="headerlink" title="5.1 通过数组实现批量删除"></a>5.1 通过数组实现批量删除</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过数组实现批量删除</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">deleteMoreByArray</span><span class="params">(<span class="meta">@Param(&quot;eids&quot;)</span> Integer[] eids)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--int deleteMoreByArray(@Param(&quot;eids&quot;) Integer[] eids);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteMoreByArray&quot;</span>&gt;</span></span><br><span class="line">    delete from t_emp where</span><br><span class="line">    <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;eids&quot;</span> <span class="attr">item</span>=<span class="string">&quot;eid&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;or&quot;</span>&gt;</span></span><br><span class="line">        eid = #&#123;eid&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        delete from t_emp where eid in</span></span><br><span class="line"><span class="comment">        &lt;foreach collection=&quot;eids&quot; item=&quot;eid&quot; separator=&quot;,&quot; open=&quot;(&quot; close=&quot;)&quot;&gt;</span></span><br><span class="line"><span class="comment">            #&#123;eid&#125;</span></span><br><span class="line"><span class="comment">        &lt;/foreach&gt;</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteMoreByArray</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = SqlSessionUtils.getSqlSession();</span><br><span class="line">    DynamicSQLMapper mapper = sqlSession.getMapper(DynamicSQLMapper.class);</span><br><span class="line">    <span class="keyword">int</span> result = mapper.deleteMoreByArray(<span class="keyword">new</span> Integer[]&#123;<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>&#125;);</span><br><span class="line">    System.out.println(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0</span><br></pre></td></tr></table></figure>

<h6 id="5-2-通过list集合实现批量添加"><a href="#5-2-通过list集合实现批量添加" class="headerlink" title="5.2 通过list集合实现批量添加"></a>5.2 通过list集合实现批量添加</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过list集合实现批量添加</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">insertMoreByList</span><span class="params">(<span class="meta">@Param(&quot;emps&quot;)</span> List&lt;Emp&gt; emps)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--int insertMoreByList(@Param(&quot;emps&quot;) List&lt;Emp&gt; emps);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertMoreByList&quot;</span>&gt;</span></span><br><span class="line">    insert into t_emp values</span><br><span class="line">    <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;emps&quot;</span> <span class="attr">item</span>=<span class="string">&quot;emp&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">        (null,#&#123;emp.empName&#125;,#&#123;emp.age&#125;,#&#123;emp.sex&#125;,#&#123;emp.email&#125;,null)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsertMoreByList</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = SqlSessionUtils.getSqlSession();</span><br><span class="line">    DynamicSQLMapper mapper = sqlSession.getMapper(DynamicSQLMapper.class);</span><br><span class="line">    Emp emp1 = <span class="keyword">new</span> Emp(<span class="keyword">null</span>,<span class="string">&quot;a1&quot;</span>,<span class="number">23</span>,<span class="string">&quot;男&quot;</span>,<span class="string">&quot;123@qq.com&quot;</span>);</span><br><span class="line">    Emp emp2 = <span class="keyword">new</span> Emp(<span class="keyword">null</span>,<span class="string">&quot;a2&quot;</span>,<span class="number">23</span>,<span class="string">&quot;男&quot;</span>,<span class="string">&quot;123@qq.com&quot;</span>);</span><br><span class="line">    Emp emp3 = <span class="keyword">new</span> Emp(<span class="keyword">null</span>,<span class="string">&quot;a3&quot;</span>,<span class="number">23</span>,<span class="string">&quot;男&quot;</span>,<span class="string">&quot;123@qq.com&quot;</span>);</span><br><span class="line">    List&lt;Emp&gt; emps = Arrays.asList(emp1, emp2, emp3);</span><br><span class="line">    System.out.println(mapper.insertMoreByList(emps));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">11</span>:<span class="number">34</span>:<span class="number">04.956</span> [main] DEBUG org.apache.ibatis.datasource.pooled.PooledDataSource - Created connection <span class="number">1513608173.</span></span><br><span class="line"><span class="number">11</span>:<span class="number">34</span>:<span class="number">04.974</span> [main] DEBUG com.ya.mybatis.mapper.DynamicSQLMapper.insertMoreByList - =<span class="function">=&gt;</span>  Preparing: insert into t_emp values (<span class="literal">null</span>,?,?,?,?,<span class="literal">null</span>) , (<span class="literal">null</span>,?,?,?,?,<span class="literal">null</span>) , (<span class="literal">null</span>,?,?,?,?,<span class="literal">null</span>)</span><br><span class="line"><span class="number">11</span>:<span class="number">34</span>:<span class="number">05.077</span> [main] DEBUG com.ya.mybatis.mapper.DynamicSQLMapper.insertMoreByList - =<span class="function">=&gt;</span> Parameters: a1(<span class="built_in">String</span>), <span class="number">23</span>(Integer), 男(<span class="built_in">String</span>), <span class="number">123</span>@qq.com(<span class="built_in">String</span>), a2(<span class="built_in">String</span>), <span class="number">23</span>(Integer), 男(<span class="built_in">String</span>), <span class="number">123</span>@qq.com(<span class="built_in">String</span>), a3(<span class="built_in">String</span>), <span class="number">23</span>(Integer), 男(<span class="built_in">String</span>), <span class="number">123</span>@qq.com(<span class="built_in">String</span>)</span><br><span class="line"><span class="number">11</span>:<span class="number">34</span>:<span class="number">05.225</span> [main] DEBUG com.ya.mybatis.mapper.DynamicSQLMapper.insertMoreByList - &lt;==    Updates: <span class="number">3</span></span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>

<h5 id="6、SQL片段"><a href="#6、SQL片段" class="headerlink" title="6、SQL片段"></a>6、SQL片段</h5><p>减少SQL语句的重复代码，比如字段名可以在外面设置好再到SQL查询语句中直接引用，这样代码就会缩短。</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">设置<span class="keyword">SQL</span>片段：&lt;<span class="keyword">sql</span> id=&quot;empColumns&quot;&gt;eid,emp_name,age,sex,email&lt;/<span class="keyword">sql</span>&gt;</span><br><span class="line">引用<span class="keyword">SQL</span>片段：&lt;<span class="keyword">include</span> refid=&quot;empColumns&quot;&gt;&lt;/<span class="keyword">include</span>&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">&quot;empColumns&quot;</span>&gt;</span>eid,emp_name,age,sex,email<span class="tag">&lt;/<span class="name">sql</span>&gt;</span>		//其他SQL语句查询要用到eid,emp_name,age,sex,email这些字段名时，直接引用id=&quot;empColumns&quot;就可以了。</span><br></pre></td></tr></table></figure>





<h4 id="十、MyBatis的缓存"><a href="#十、MyBatis的缓存" class="headerlink" title="十、MyBatis的缓存"></a>十、MyBatis的缓存</h4><p>【代码在mybatis03】</p>
<p>缓存针对的是查询功能。</p>
<p><strong>数据库接口CacheMapper.java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CacheMapper</span> </span>&#123;</span><br><span class="line">    <span class="function">Emp <span class="title">getEmpByEid</span><span class="params">(<span class="meta">@Param(&quot;eid&quot;)</span> Integer eid)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insertEmp</span><span class="params">(Emp emp)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="1、MyBatis的一级缓存"><a href="#1、MyBatis的一级缓存" class="headerlink" title="1、MyBatis的一级缓存"></a>1、MyBatis的一级缓存</h5><p>一级缓存是默认开启的。</p>
<p>一级缓存是<strong>SqlSession</strong>级别的，通过同一个<code>SqlSession</code>查询的数据会被缓存，下次查询相同的数据，就会从缓存中直接获取，不会从数据库重新访问。</p>
<p>使一级缓存失效的四种情况：</p>
<ol>
<li>不同的SqlSession对应不同的一级缓存</li>
<li>同一个SqlSession但是查询条件不同</li>
<li>同一个SqlSession两次查询期间执行了任何一次增删改操作</li>
<li>同一个SqlSession两次查询期间手动清空了缓存 <code>sqlSession.clearCache();</code></li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--Emp getEmpByEid(@Param(&quot;eid&quot;) Integer eid);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpByEid&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line">    select * from t_emp where eid = #&#123;eid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>   <span class="comment">//一级缓存</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testOneCache</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession1 = SqlSessionUtils.getSqlSession();</span><br><span class="line">    CacheMapper mapper1 = sqlSession1.getMapper(CacheMapper.class);</span><br><span class="line">    Emp emp1 = mapper1.getEmpByEid(<span class="number">1</span>);</span><br><span class="line">    System.out.println(emp1);</span><br><span class="line">    <span class="comment">//mapper1.insertEmp(new Emp(null,&quot;abc&quot;,23,&quot;男&quot;,&quot;123@qq.com&quot;));</span></span><br><span class="line">    sqlSession1.clearCache();</span><br><span class="line">    Emp emp2 = mapper1.getEmpByEid(<span class="number">1</span>);</span><br><span class="line">    System.out.println(emp2);</span><br><span class="line">    <span class="comment">/*SqlSession sqlSession2 = SqlSessionUtils.getSqlSession();</span></span><br><span class="line"><span class="comment">    CacheMapper mapper2 = sqlSession2.getMapper(CacheMapper.class);</span></span><br><span class="line"><span class="comment">    Emp emp2 = mapper2.getEmpByEid(1);</span></span><br><span class="line"><span class="comment">    System.out.println(emp2);*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">21:42:08.561 [main] <span class="builtin-name">DEBUG</span> org.apache.ibatis.datasource.pooled.PooledDataSource - Created<span class="built_in"> connection </span>1384210339.</span><br><span class="line">21:42:08.572 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.CacheMapper.getEmpByEid - ==&gt;  Preparing: select * <span class="keyword">from</span> t_emp where eid = ?</span><br><span class="line">21:42:08.651 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.CacheMapper.getEmpByEid - ==&gt; Parameters: 1(Integer)</span><br><span class="line">21:42:08.842 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.CacheMapper.getEmpByEid - &lt;==      Total: 1</span><br><span class="line">Emp&#123;<span class="attribute">eid</span>=1, <span class="attribute">empName</span>=<span class="string">&#x27;张三&#x27;</span>, <span class="attribute">age</span>=20, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;123@qq.com&#x27;</span>, <span class="attribute">dept</span>=<span class="literal">null</span>&#125;</span><br><span class="line">21:42:08.848 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.CacheMapper - Cache Hit Ratio [com.ya.mybatis.mapper.CacheMapper]: 0.0</span><br><span class="line">21:42:08.848 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.CacheMapper.getEmpByEid - ==&gt;  Preparing: select * <span class="keyword">from</span> t_emp where eid = ?</span><br><span class="line">21:42:08.848 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.CacheMapper.getEmpByEid - ==&gt; Parameters: 1(Integer)</span><br><span class="line">21:42:09.036 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.CacheMapper.getEmpByEid - &lt;==      Total: 1</span><br><span class="line">Emp&#123;<span class="attribute">eid</span>=1, <span class="attribute">empName</span>=<span class="string">&#x27;张三&#x27;</span>, <span class="attribute">age</span>=20, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;123@qq.com&#x27;</span>, <span class="attribute">dept</span>=<span class="literal">null</span>&#125;</span><br></pre></td></tr></table></figure>



<p>测试手动进行增删来影响缓存</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--void insertEmp(Emp emp);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertEmp&quot;</span>&gt;</span></span><br><span class="line">    insert into t_emp values(null,#&#123;empName&#125;,#&#123;age&#125;,#&#123;sex&#125;,#&#123;email&#125;,null)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="2、MyBatis的二级缓存"><a href="#2、MyBatis的二级缓存" class="headerlink" title="2、MyBatis的二级缓存"></a>2、MyBatis的二级缓存</h5><p>二级缓存是<strong>SqlSessionFactory</strong>级别，通过同一个SqlSessionFactory创建的SqlSession查询的结果会被缓存；此后若再次执行相同的查询语句，结果就会从缓存中获取。</p>
<p>二级缓存开启的条件：</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">在核心配置文件中，设置全局配置属性cacheEnabled=<span class="string">&quot;true&quot;</span>，默认为<span class="literal">true</span>，不需要设置</span><br><span class="line">在映射文件中设置标签&lt;<span class="keyword">cache</span> /&gt;</span><br><span class="line">二级缓存必须在SqlSession关闭或提交之后有效</span><br><span class="line">查询的数据所转换的实体类类型必须实现序列化的接口</span><br></pre></td></tr></table></figure>

<p>使二级缓存失效的情况：两次查询之间执行了任意的增删改，会使一级和二级缓存同时失效</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>   <span class="comment">//二级缓存</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testTwoCache</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        InputStream is = Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">        SqlSession sqlSession1 = sqlSessionFactory.openSession(<span class="keyword">true</span>);</span><br><span class="line">        CacheMapper mapper1 = sqlSession1.getMapper(CacheMapper.class);</span><br><span class="line">        System.out.println(mapper1.getEmpByEid(<span class="number">1</span>));</span><br><span class="line">        sqlSession1.close();		<span class="comment">//关闭</span></span><br><span class="line">        SqlSession sqlSession2 = sqlSessionFactory.openSession(<span class="keyword">true</span>);</span><br><span class="line">        CacheMapper mapper2 = sqlSession2.getMapper(CacheMapper.class);</span><br><span class="line">        System.out.println(mapper2.getEmpByEid(<span class="number">1</span>));</span><br><span class="line">        sqlSession2.close();		<span class="comment">//关闭</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">11:41:29.265 [main] <span class="builtin-name">DEBUG</span> org.apache.ibatis.datasource.pooled.PooledDataSource - Created<span class="built_in"> connection </span>1384210339.</span><br><span class="line">11:41:29.276 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.CacheMapper.getEmpByEid - ==&gt;  Preparing: select * <span class="keyword">from</span> t_emp where eid = ?</span><br><span class="line">11:41:29.340 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.CacheMapper.getEmpByEid - ==&gt; Parameters: 1(Integer)</span><br><span class="line">11:41:29.546 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.CacheMapper.getEmpByEid - &lt;==      Total: 1</span><br><span class="line">Emp&#123;<span class="attribute">eid</span>=1, <span class="attribute">empName</span>=<span class="string">&#x27;张三&#x27;</span>, <span class="attribute">age</span>=20, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;123@qq.com&#x27;</span>, <span class="attribute">dept</span>=<span class="literal">null</span>&#125;</span><br><span class="line">11:41:29.554 [main] <span class="builtin-name">DEBUG</span> net.sf.ehcache.store.disk.Segment - put added 0 on heap</span><br><span class="line">11:41:29.556 [main] <span class="builtin-name">DEBUG</span> org.apache.ibatis.transaction.jdbc.JdbcTransaction - Closing JDBC<span class="built_in"> Connection </span>[com.mysql.cj.jdbc.ConnectionImpl@52815fa3]</span><br><span class="line">11:41:29.556 [main] <span class="builtin-name">DEBUG</span> org.apache.ibatis.datasource.pooled.PooledDataSource - Returned<span class="built_in"> connection </span>1384210339 <span class="keyword">to</span> pool.</span><br><span class="line">11:41:29.557 [main] <span class="builtin-name">DEBUG</span> com.ya.mybatis.mapper.CacheMapper - Cache Hit Ratio [com.ya.mybatis.mapper.CacheMapper]: 0.5</span><br><span class="line">Emp&#123;<span class="attribute">eid</span>=1, <span class="attribute">empName</span>=<span class="string">&#x27;张三&#x27;</span>, <span class="attribute">age</span>=20, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;123@qq.com&#x27;</span>, <span class="attribute">dept</span>=<span class="literal">null</span>&#125;</span><br></pre></td></tr></table></figure>

<p>以上的测试结果可以看出，只执行了一次SQL语句就能获取两次结果。</p>
<h5 id="3、二级缓存的相关配置"><a href="#3、二级缓存的相关配置" class="headerlink" title="3、二级缓存的相关配置"></a>3、二级缓存的相关配置</h5><p>在mapper配置文件中添加的cache标签可以设置一些属性：</p>
<ul>
<li><p>eviction属性：缓存回收策略</p>
<p>LRU（Least Recently Used） – 最近最少使用的：移除最长时间不被使用的对象。</p>
<p>FIFO（First in First out） – 先进先出：按对象进入缓存的顺序来移除它们。</p>
<p>SOFT – 软引用：移除基于垃圾回收器状态和软引用规则的对象。</p>
<p>WEAK – 弱引用：更积极地移除基于垃圾收集器状态和弱引用规则的对象。</p>
<p>默认的是 LRU。</p>
</li>
<li><p>flushInterval属性：刷新间隔，单位毫秒</p>
<p>默认情况是不设置，也就是没有刷新间隔，缓存仅仅调用语句时刷新</p>
</li>
<li><p>size属性：引用数目，正整数</p>
<p>代表缓存最多可以存储多少个对象，太大容易导致内存溢出</p>
</li>
<li><p>readOnly属性：只读，true/false</p>
<p>true：只读缓存；会给所有调用者返回缓存对象的相同实例。因此这些对象不能被修改。这提供了很重要的性能优势。</p>
<p>false：读写缓存；会返回缓存对象的拷贝（通过序列化）。这会慢一些，但是安全，因此默认是false。 </p>
</li>
</ul>
<h5 id="4、MyBatis缓存查询的顺序"><a href="#4、MyBatis缓存查询的顺序" class="headerlink" title="4、MyBatis缓存查询的顺序"></a>4、MyBatis缓存查询的顺序</h5><p><strong>查询顺序：二级——一级——数据库</strong></p>
<p>先查询二级缓存，因为二级缓存中可能会有其他程序已经查出来的数据，可以拿来直接使用。<br>如果二级缓存没有命中，再查询一级缓存。<br>如果一级缓存也没有命中，则查询数据库。<br>SqlSession关闭之后，一级缓存中的数据会写入二级缓存。</p>
<h5 id="5、整合第三方缓存EHCache"><a href="#5、整合第三方缓存EHCache" class="headerlink" title="5、整合第三方缓存EHCache"></a>5、整合第三方缓存EHCache</h5><p>EHCache官网：<a target="_blank" rel="noopener" href="https://www.ehcache.org/">https://www.ehcache.org/</a></p>
<p><strong>添加依赖</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Mybatis EHCache整合包 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.caches<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-ehcache<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- slf4j日志门面的一个具体实现 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-classic<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>各jar包功能</strong><br>mybatis-ehcache：Mybatis和EHCache的整合包<br>ehcache：EHCache核心包<br>slf4j-api：SLF4J日志门面包<br>logback-classic：支持SLF4J门面接口的一个具体实现</p>
<p><strong>创建EHCache的配置文件ehcache.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ehcache</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:noNamespaceSchemaLocation</span>=<span class="string">&quot;../config/ehcache.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 磁盘保存路径 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">diskStore</span> <span class="attr">path</span>=<span class="string">&quot;D:\MyITData\JavaIDEA\JavaStudy\MyBatis\ehcache&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">defaultCache</span></span></span><br><span class="line"><span class="tag">            <span class="attr">maxElementsInMemory</span>=<span class="string">&quot;1000&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">maxElementsOnDisk</span>=<span class="string">&quot;10000000&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">eternal</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">overflowToDisk</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">timeToIdleSeconds</span>=<span class="string">&quot;120&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">timeToLiveSeconds</span>=<span class="string">&quot;120&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">diskExpiryThreadIntervalSeconds</span>=<span class="string">&quot;120&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">memoryStoreEvictionPolicy</span>=<span class="string">&quot;LRU&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">defaultCache</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ehcache</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>设置二级缓存的类型</strong></p>
<p>在CacheMapper.xml中进行设置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--整合第三方缓存ehcache时设置二级缓存的类型--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">cache</span> <span class="attr">type</span>=<span class="string">&quot;org.mybatis.caches.ehcache.EhcacheCache&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>加入logback日志</strong></p>
<p>存在SLF4J时，作为简易日志的log4j将失效，此时我们需要借助SLF4J的具体实现logback来打印日志。</p>
<p>创建logback的配置文件logback.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">debug</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 指定日志输出的位置 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;STDOUT&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 日志输出的格式 --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 按照顺序分别是：时间、日志级别、线程名称、打印日志的类、日志主体内容、换行 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>[%d&#123;HH:mm:ss.SSS&#125;] [%-5level] [%thread] [%logger] [%msg]%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 设置全局日志级别。日志级别按顺序分别是：DEBUG、INFO、WARN、ERROR --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 指定任何一个日志级别都只打印当前级别和后面级别的日志。 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;DEBUG&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 指定打印日志的appender，这里通过“STDOUT”引用了前面配置的appender --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;STDOUT&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 根据特殊需求指定局部日志级别 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;com.ya.crowd.mapper&quot;</span> <span class="attr">level</span>=<span class="string">&quot;DEBUG&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>再次测试二级缓存，测试结果和未使用ehcache时是一样的。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[12:12:59.739] [<span class="builtin-name">DEBUG</span>] [main] [org.apache.ibatis.datasource.pooled.PooledDataSource] [Created<span class="built_in"> connection </span>878668275.]</span><br><span class="line">[12:12:59.748] [<span class="builtin-name">DEBUG</span>] [main] [com.ya.mybatis.mapper.CacheMapper.getEmpByEid] [==&gt;  Preparing: select * <span class="keyword">from</span> t_emp where eid = ?]</span><br><span class="line">[12:12:59.797] [<span class="builtin-name">DEBUG</span>] [main] [com.ya.mybatis.mapper.CacheMapper.getEmpByEid] [==&gt; Parameters: 1(Integer)]</span><br><span class="line">[12:12:59.889] [<span class="builtin-name">DEBUG</span>] [main] [com.ya.mybatis.mapper.CacheMapper.getEmpByEid] [&lt;==      Total: 1]</span><br><span class="line">Emp&#123;<span class="attribute">eid</span>=1, <span class="attribute">empName</span>=<span class="string">&#x27;张三&#x27;</span>, <span class="attribute">age</span>=20, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;123@qq.com&#x27;</span>, <span class="attribute">dept</span>=<span class="literal">null</span>&#125;</span><br><span class="line">[12:12:59.892] [<span class="builtin-name">DEBUG</span>] [main] [net.sf.ehcache.store.disk.Segment] [put added 0 on heap]</span><br><span class="line">[12:12:59.893] [<span class="builtin-name">DEBUG</span>] [main] [org.apache.ibatis.transaction.jdbc.JdbcTransaction] [Closing JDBC<span class="built_in"> Connection </span>[com.mysql.cj.jdbc.ConnectionImpl@345f69f3]]</span><br><span class="line">[12:12:59.893] [<span class="builtin-name">DEBUG</span>] [main] [org.apache.ibatis.datasource.pooled.PooledDataSource] [Returned<span class="built_in"> connection </span>878668275 <span class="keyword">to</span> pool.]</span><br><span class="line">[12:12:59.893] [<span class="builtin-name">DEBUG</span>] [main] [com.ya.mybatis.mapper.CacheMapper] [Cache Hit Ratio [com.ya.mybatis.mapper.CacheMapper]: 0.5]</span><br><span class="line">Emp&#123;<span class="attribute">eid</span>=1, <span class="attribute">empName</span>=<span class="string">&#x27;张三&#x27;</span>, <span class="attribute">age</span>=20, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;123@qq.com&#x27;</span>, <span class="attribute">dept</span>=<span class="literal">null</span>&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>此时，查看目录<code>D:\MyITData\JavaIDEA\JavaStudy\MyBatis\ehcache</code>发现已有相关的缓存</p>
<img src="https://raw.githubusercontent.com/yagote/blog-image/master/202310021103671.png" alt="image-20220524121444646" style="zoom:80%;" />





<h4 id="十一、MyBatis的逆向工程"><a href="#十一、MyBatis的逆向工程" class="headerlink" title="十一、MyBatis的逆向工程"></a>十一、MyBatis的逆向工程</h4><p>【代码在mybatis04】</p>
<p>正向工程：先创建Java实体类，由框架负责根据实体类生成数据库表。Hibernate是支持正向工程的。</p>
<p>逆向工程：先创建数据库表，由框架负责根据数据库表，反向生成资源：Java实体类、Mapper接口、Mapper映射文件</p>
<h5 id="1、创建逆向工程的步骤"><a href="#1、创建逆向工程的步骤" class="headerlink" title="1、创建逆向工程的步骤"></a>1、创建逆向工程的步骤</h5><p>添加依赖和插件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 依赖MyBatis核心包 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span>   </span><br><span class="line"><span class="comment">&lt;!-- 控制Maven在构建过程中相关配置 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 构建过程中用到的插件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 具体插件，逆向工程的操作是以构建过程中插件形式出现的 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!-- 插件的依赖 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">&lt;!-- 逆向工程的核心依赖 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">&lt;!-- 数据库连接池 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mchange<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">&lt;!-- MySQL驱动 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>创建MyBatis的核心配置文件mybatis-config.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--引入properties文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;jdbc.properties&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--设置类型别名--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.ya.mybatis.pojo&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--引入映射文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.ya.mybatis.mapper&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>创建逆向工程的配置文件，文件名必须为<code>generatorConfig.xml</code></p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">targetRuntime:</span> 执行生成的逆向工程的版本</span><br><span class="line"><span class="symbol">MyBatis3Simple:</span> 生成基本的CRUD（清新简洁版）</span><br><span class="line"><span class="symbol">MyBatis3:</span> 生成带条件的CRUD（奢华尊享版）</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">generatorConfiguration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            targetRuntime: 执行生成的逆向工程的版本</span></span><br><span class="line"><span class="comment">                    MyBatis3Simple: 生成基本的CRUD（清新简洁版）</span></span><br><span class="line"><span class="comment">                    MyBatis3: 生成带条件的CRUD（奢华尊享版）</span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">&quot;DB2Tables&quot;</span> <span class="attr">targetRuntime</span>=<span class="string">&quot;MyBatis3&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 数据库的连接信息 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">jdbcConnection</span> <span class="attr">driverClass</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">connectionURL</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/mybatis?useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=utf8&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">userId</span>=<span class="string">&quot;root&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">password</span>=<span class="string">&quot;123&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- javaBean的生成策略--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">&quot;com.ya.mybatis.pojo&quot;</span> <span class="attr">targetProject</span>=<span class="string">&quot;.\src\main\java&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;enableSubPackages&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;trimStrings&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaModelGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- SQL映射文件的生成策略 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">&quot;com.ya.mybatis.mapper&quot;</span>  <span class="attr">targetProject</span>=<span class="string">&quot;.\src\main\resources&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;enableSubPackages&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">sqlMapGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Mapper接口的生成策略 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">type</span>=<span class="string">&quot;XMLMAPPER&quot;</span> <span class="attr">targetPackage</span>=<span class="string">&quot;com.ya.mybatis.mapper&quot;</span>  <span class="attr">targetProject</span>=<span class="string">&quot;.\src\main\java&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;enableSubPackages&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaClientGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 逆向分析的表 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- tableName设置为*号，可以对应所有表，此时不写domainObjectName --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- domainObjectName属性指定生成出来的实体类的类名 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">&quot;t_emp&quot;</span> <span class="attr">domainObjectName</span>=<span class="string">&quot;Emp&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">&quot;t_dept&quot;</span> <span class="attr">domainObjectName</span>=<span class="string">&quot;Dept&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>执行MBG插件的generate目标</p>
<img src="https://raw.githubusercontent.com/yagote/blog-image/master/202310021103672.png" alt="image-20220526090125811" style="zoom:80%;" />



<p>双击后就会自动生成代码了</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[<span class="builtin-name">INFO</span>] Scanning <span class="keyword">for</span> projects<span class="built_in">..</span>.</span><br><span class="line">[<span class="builtin-name">INFO</span>] </span><br><span class="line">[<span class="builtin-name">INFO</span>] ----------------------&lt; com.mybatis04:mybatis04 &gt;-----------------------</span><br><span class="line">[<span class="builtin-name">INFO</span>] Building mybatis04 1.0-SNAPSHOT</span><br><span class="line">[<span class="builtin-name">INFO</span>] --------------------------------[ jar ]---------------------------------</span><br><span class="line">[<span class="builtin-name">INFO</span>] </span><br><span class="line">[<span class="builtin-name">INFO</span>] --- mybatis-generator-maven-plugin:1.3.0:generate (default-cli) @ mybatis04 ---</span><br><span class="line">[<span class="builtin-name">INFO</span>] ------------------------------------------------------------------------</span><br><span class="line">[<span class="builtin-name">INFO</span>] BUILD SUCCESS</span><br><span class="line">[<span class="builtin-name">INFO</span>] ------------------------------------------------------------------------</span><br><span class="line">[<span class="builtin-name">INFO</span>] Total time:  1.849 s</span><br><span class="line">[<span class="builtin-name">INFO</span>] Finished at: 2022-05-26T09:09:00+08:00</span><br><span class="line">[<span class="builtin-name">INFO</span>] ------------------------------------------------------------------------</span><br></pre></td></tr></table></figure>

<p>未双击时的项目结构</p>
<img src="https://raw.githubusercontent.com/yagote/blog-image/master/202310021103673.png" alt="image-20220526090247679" style="zoom:80%;" />

<p>双击执行后的项目结构，框起来的是自动生成的代码。</p>
<img src="https://raw.githubusercontent.com/yagote/blog-image/master/202310021103674.png" alt="image-20220526091122949" style="zoom:80%;" />



<p>实体对象类中还生成了一个xxExample类，这个类主要是用来进行单表的查询条件操作的，可以去掉，但还是留着吧。</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mybatis的逆向工程中会生成实例及实例对应的<span class="module-access"><span class="module"><span class="identifier">XXExample</span>.</span></span>java，<span class="module-access"><span class="module"><span class="identifier">XXExample</span>.</span></span>java包含了对象的常用查询方法</span><br><span class="line">XXExample有三个内部类，GeneratedCriteria，Criteria，Criterion</span><br><span class="line"></span><br><span class="line">example.set<span class="constructor">OrderByClause(“字段名 ASC”)</span>; 	添加升序排列条件，DESC为降序</span><br><span class="line">example.set<span class="constructor">Distinct(<span class="params">false</span>)</span> 	去除重复，boolean型，<span class="literal">true</span>为选择不重复的记录。</span><br><span class="line">criteria.andXxxIsNull 	添加字段xxx为null的条件</span><br><span class="line">criteria.andXxxIsNotNull 	添加字段xxx不为null的条件</span><br><span class="line">criteria.<span class="keyword">and</span><span class="constructor">XxxEqualTo(<span class="params">value</span>)</span> 	添加xxx字段等于value条件</span><br><span class="line">criteria.<span class="keyword">and</span><span class="constructor">XxxNotEqualTo(<span class="params">value</span>)</span> 	添加xxx字段不等于value条件</span><br><span class="line">criteria.<span class="keyword">and</span><span class="constructor">XxxGreaterThan(<span class="params">value</span>)</span> 	添加xxx字段大于value条件</span><br><span class="line">criteria.<span class="keyword">and</span><span class="constructor">XxxGreaterThanOrEqualTo(<span class="params">value</span>)</span> 	添加xxx字段大于等于value条件</span><br><span class="line">criteria.<span class="keyword">and</span><span class="constructor">XxxLessThan(<span class="params">value</span>)</span> 	添加xxx字段小于value条件</span><br><span class="line">criteria.<span class="keyword">and</span><span class="constructor">XxxLessThanOrEqualTo(<span class="params">value</span>)</span> 	添加xxx字段小于等于value条件</span><br><span class="line">criteria.<span class="keyword">and</span><span class="constructor">XxxIn(List&lt;？&gt;)</span> 	添加xxx字段值在List&lt;？&gt;条件</span><br><span class="line">criteria.<span class="keyword">and</span><span class="constructor">XxxNotIn(List&lt;？&gt;)</span> 	添加xxx字段值不在List&lt;？&gt;条件</span><br><span class="line">criteria.<span class="keyword">and</span><span class="constructor">XxxLike(“%”+<span class="params">value</span>+”%”)</span> 	添加xxx字段值为value的模糊查询条件</span><br><span class="line">criteria.<span class="keyword">and</span><span class="constructor">XxxNotLike(“%”+<span class="params">value</span>+”%”)</span> 	添加xxx字段值不为value的模糊查询条件</span><br><span class="line">criteria.<span class="keyword">and</span><span class="constructor">XxxBetween(<span class="params">value1</span>,<span class="params">value2</span>)</span> 	添加xxx字段值在value1和value2之间条件</span><br><span class="line">criteria.<span class="keyword">and</span><span class="constructor">XxxNotBetween(<span class="params">value1</span>,<span class="params">value2</span>)</span> 	添加xxx字段值不在value1和value2之间条件</span><br></pre></td></tr></table></figure>

<p>有关xxExample类的介绍看<a target="_blank" rel="noopener" href="https://www.itdaan.com/blog/2018/06/27/d7cb53dba01ab048300f68e83b5c333c.html">https://www.itdaan.com/blog/2018/06/27/d7cb53dba01ab048300f68e83b5c333c.html</a></p>
<h5 id="2、QBC查询"><a href="#2、QBC查询" class="headerlink" title="2、QBC查询"></a>2、QBC查询</h5><p>QBC即选择性查询。</p>
<blockquote>
<p>查询若出现以下错误，则把数据库的连接修改一下</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jdbc.url=jdbc<span class="function">:mysql</span>:<span class="string">//localhost</span><span class="function">:3306</span>/mybatis?useUnicode=<span class="literal">true</span>&amp;characterEncoding=utf8	<span class="string">//</span>这是jdbc.properties的配置</span><br><span class="line"></span><br><span class="line">jdbc<span class="function">:mysql</span>:<span class="string">//IP</span>地址<span class="function">:3306</span>/mybatis?useUnicode=<span class="literal">true</span>&amp;amp;characterEncoding=utf8	<span class="string">//</span>这是generatorConfig.xml的配置</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">Unknown</span> <span class="keyword">initial</span> <span class="type">character</span> <span class="keyword">set</span> index <span class="string">&#x27;255&#x27;</span> received <span class="keyword">from</span> server. <span class="keyword">Initial</span> client <span class="type">character</span> <span class="keyword">set</span> can be forced via the <span class="string">&#x27;characterEncoding&#x27;</span> property.</span><br></pre></td></tr></table></figure>
</blockquote>
<p>在要查询的实体类中添加有参构造和无参构造，重写toString()方法</p>
<p><strong>(1) 查询所有</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMBG</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           InputStream is = Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line">           SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">           SqlSession sqlSession = sqlSessionFactory.openSession(<span class="keyword">true</span>);</span><br><span class="line">           EmpMapper mapper = sqlSession.getMapper(EmpMapper.class);</span><br><span class="line">           <span class="comment">//查询所有数据</span></span><br><span class="line">           List&lt;Emp&gt; list = mapper.selectByExample(<span class="keyword">null</span>);</span><br><span class="line">           list.forEach(emp -&gt; System.out.println(emp));</span><br><span class="line"></span><br><span class="line">       &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>控制台输出的对应的查询语句和查询结果</p>
<p><code>select eid, emp_name, age, sex, email, did from t_emp</code></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">DEBUG</span> 05-26 16:51:07,727 ==&gt;  Preparing: select eid, emp_name, age, sex, email, did <span class="keyword">from</span> t_emp  (BaseJdbcLogger.java:137) </span><br><span class="line"><span class="builtin-name">DEBUG</span> 05-26 16:51:07,756 ==&gt; Parameters:   (BaseJdbcLogger.java:137) </span><br><span class="line"><span class="builtin-name">DEBUG</span> 05-26 16:51:07,842 &lt;==      Total: 8  (BaseJdbcLogger.java:137) </span><br><span class="line">Emp&#123;<span class="attribute">eid</span>=1, <span class="attribute">empName</span>=<span class="string">&#x27;张三&#x27;</span>, <span class="attribute">age</span>=20, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;123@qq.com&#x27;</span>, <span class="attribute">did</span>=1&#125;</span><br><span class="line">Emp&#123;<span class="attribute">eid</span>=2, <span class="attribute">empName</span>=<span class="string">&#x27;李四&#x27;</span>, <span class="attribute">age</span>=21, <span class="attribute">sex</span>=<span class="string">&#x27;女&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;234@qq.com&#x27;</span>, <span class="attribute">did</span>=2&#125;</span><br><span class="line">Emp&#123;<span class="attribute">eid</span>=3, <span class="attribute">empName</span>=<span class="string">&#x27;王五&#x27;</span>, <span class="attribute">age</span>=22, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;345@qq.com&#x27;</span>, <span class="attribute">did</span>=3&#125;</span><br><span class="line">Emp&#123;<span class="attribute">eid</span>=4, <span class="attribute">empName</span>=<span class="string">&#x27;赵六&#x27;</span>, <span class="attribute">age</span>=23, <span class="attribute">sex</span>=<span class="string">&#x27;女&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;456@qq.com&#x27;</span>, <span class="attribute">did</span>=1&#125;</span><br><span class="line">Emp&#123;<span class="attribute">eid</span>=5, <span class="attribute">empName</span>=<span class="string">&#x27;田七&#x27;</span>, <span class="attribute">age</span>=24, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;567@qq.com&#x27;</span>, <span class="attribute">did</span>=2&#125;</span><br><span class="line">Emp&#123;<span class="attribute">eid</span>=<span class="literal">null</span>, <span class="attribute">empName</span>=<span class="string">&#x27;a1&#x27;</span>, <span class="attribute">age</span>=23, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;123@qq.com&#x27;</span>, <span class="attribute">did</span>=<span class="literal">null</span>&#125;</span><br><span class="line">Emp&#123;<span class="attribute">eid</span>=<span class="literal">null</span>, <span class="attribute">empName</span>=<span class="string">&#x27;a2&#x27;</span>, <span class="attribute">age</span>=23, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;123@qq.com&#x27;</span>, <span class="attribute">did</span>=<span class="literal">null</span>&#125;</span><br><span class="line">Emp&#123;<span class="attribute">eid</span>=<span class="literal">null</span>, <span class="attribute">empName</span>=<span class="string">&#x27;a3&#x27;</span>, <span class="attribute">age</span>=23, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;123@qq.com&#x27;</span>, <span class="attribute">did</span>=<span class="literal">null</span>&#125;</span><br></pre></td></tr></table></figure>

<p><strong>(2) 根据条件查询，这里用到这个实体类EmpExample.java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMBG</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        InputStream is = Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">        SqlSession sqlSession = sqlSessionFactory.openSession(<span class="keyword">true</span>);</span><br><span class="line">        EmpMapper mapper = sqlSession.getMapper(EmpMapper.class);</span><br><span class="line">        <span class="comment">//根据条件查询</span></span><br><span class="line">        EmpExample example = <span class="keyword">new</span> EmpExample();</span><br><span class="line">        example.createCriteria().andEmpNameEqualTo(<span class="string">&quot;张三&quot;</span>).andAgeGreaterThanOrEqualTo(<span class="number">20</span>);</span><br><span class="line">        example.or().andDidIsNotNull();</span><br><span class="line">        List&lt;Emp&gt; list = mapper.selectByExample(example);</span><br><span class="line">        list.forEach(emp -&gt; System.out.println(emp));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>控制台输出的对应的查询语句和查询结果</p>
<p><code>select eid, emp_name, age, sex, email, did from t_emp WHERE ( emp_name = ? and age &gt;= ? ) or( did is not null )</code></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">DEBUG</span> 05-26 16:55:09,018 ==&gt;  Preparing: select eid, emp_name, age, sex, email, did <span class="keyword">from</span> t_emp WHERE ( emp_name = ? <span class="keyword">and</span> age &gt;= ? ) <span class="keyword">or</span>( did is <span class="keyword">not</span> <span class="literal">null</span> )  (BaseJdbcLogger.java:137) </span><br><span class="line"><span class="builtin-name">DEBUG</span> 05-26 16:55:09,036 ==&gt; Parameters: 张三(String), 20(Integer)  (BaseJdbcLogger.java:137) </span><br><span class="line"><span class="builtin-name">DEBUG</span> 05-26 16:55:09,256 &lt;==      Total: 5  (BaseJdbcLogger.java:137) </span><br><span class="line">Emp&#123;<span class="attribute">eid</span>=1, <span class="attribute">empName</span>=<span class="string">&#x27;张三&#x27;</span>, <span class="attribute">age</span>=20, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;123@qq.com&#x27;</span>, <span class="attribute">did</span>=1&#125;</span><br><span class="line">Emp&#123;<span class="attribute">eid</span>=2, <span class="attribute">empName</span>=<span class="string">&#x27;李四&#x27;</span>, <span class="attribute">age</span>=21, <span class="attribute">sex</span>=<span class="string">&#x27;女&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;234@qq.com&#x27;</span>, <span class="attribute">did</span>=2&#125;</span><br><span class="line">Emp&#123;<span class="attribute">eid</span>=3, <span class="attribute">empName</span>=<span class="string">&#x27;王五&#x27;</span>, <span class="attribute">age</span>=22, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;345@qq.com&#x27;</span>, <span class="attribute">did</span>=3&#125;</span><br><span class="line">Emp&#123;<span class="attribute">eid</span>=4, <span class="attribute">empName</span>=<span class="string">&#x27;赵六&#x27;</span>, <span class="attribute">age</span>=23, <span class="attribute">sex</span>=<span class="string">&#x27;女&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;456@qq.com&#x27;</span>, <span class="attribute">did</span>=1&#125;</span><br><span class="line">Emp&#123;<span class="attribute">eid</span>=5, <span class="attribute">empName</span>=<span class="string">&#x27;田七&#x27;</span>, <span class="attribute">age</span>=24, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;567@qq.com&#x27;</span>, <span class="attribute">did</span>=2&#125;</span><br></pre></td></tr></table></figure>

<p><strong>(3) 根据主键修改，这个不知道为什么EmpMapper.java中没有生成根据主键查询的方法int updateByPrimaryKeySelective(Emp record);</strong></p>
<p>可能是数据表没有设置主键才导致没有生成这个方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMBG</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        InputStream is = Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">        SqlSession sqlSession = sqlSessionFactory.openSession(<span class="keyword">true</span>);</span><br><span class="line">        EmpMapper mapper = sqlSession.getMapper(EmpMapper.class);</span><br><span class="line">        <span class="comment">//根据主键修改</span></span><br><span class="line">        mapper.updateByPrimaryKeySelective(<span class="keyword">new</span> Emp(<span class="number">1</span>,<span class="string">&quot;admin&quot;</span>,<span class="number">22</span>,<span class="keyword">null</span>,<span class="string">&quot;456@qq.com&quot;</span>,<span class="number">3</span>));</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>控制台输出的修改语句</p>
<p>``update t_emp SET emp_name = ?, age = ?, email = ?, did = ? where eid = ?` </p>
<p><code>admin(String), 22(Integer), 456@qq.com(String), 3(Integer), 1(Integer)</code> </p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">26</span> <span class="number">17</span>:<span class="number">08</span>:<span class="number">42</span>,<span class="number">408</span> ==&gt;  Preparing: update t_emp SET emp_name = ?, age = ?, email = ?, did = ? where eid = ?  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">26</span> <span class="number">17</span>:<span class="number">08</span>:<span class="number">42</span>,<span class="number">432</span> ==&gt; Parameters: admin(String), <span class="number">22</span>(Integer), <span class="number">456</span>@qq.com(String), <span class="number">3</span>(Integer), <span class="number">1</span>(Integer)  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line"><span class="attribute">DEBUG</span> <span class="number">05</span>-<span class="number">26</span> <span class="number">17</span>:<span class="number">08</span>:<span class="number">42</span>,<span class="number">521</span> &lt;==    Updates: <span class="number">1</span>  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br></pre></td></tr></table></figure>

<p>未修改前数据库信息</p>
<img src="https://raw.githubusercontent.com/yagote/blog-image/master/202310021103675.png" alt="image-20220526170816728" style="zoom:80%;" />

<p>修改后数据库信息</p>
<img src="https://raw.githubusercontent.com/yagote/blog-image/master/202310021103676.png" alt="image-20220526171125143" style="zoom: 80%;" />





<h4 id="十二、分页插件"><a href="#十二、分页插件" class="headerlink" title="十二、分页插件"></a>十二、分页插件</h4><p>这个很重要。</p>
<p>【代码在mybatis04】</p>
<h5 id="1、分页插件使用步骤"><a href="#1、分页插件使用步骤" class="headerlink" title="1、分页插件使用步骤"></a>1、分页插件使用步骤</h5><p>添加依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--分页插件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>配置分页插件，在MyBatis的核心配置文件中配置插件，注意标签的顺序</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--设置分页插件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">interceptor</span>=<span class="string">&quot;com.github.pagehelper.PageInterceptor&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="2、分页插件的使用"><a href="#2、分页插件的使用" class="headerlink" title="2、分页插件的使用"></a>2、分页插件的使用</h5><p>分页相关数据</p>
<blockquote>
<p>常用数据：</p>
<p>pageNum：当前页的页码<br>pageSize：每页显示的条数<br>size：当前页显示的真实条数<br>total：总记录数<br>pages：总页数<br>prePage：上一页的页码<br>nextPage：下一页的页码<br>isFirstPage/isLastPage：是否为第一页/最后一页<br>hasPreviousPage/hasNextPage：是否存在上一页/下一页<br>navigatePages：导航分页的页码数<br>navigatepageNums：导航分页的页码，[1,2,3,4,5]</p>
</blockquote>
<p>分页查询步骤：</p>
<p>(1) 在查询功能之前使用<code>PageHelper.startPage(int pageNum, int pageSize)</code>开启分页功能</p>
<blockquote>
<p>pageNum：当前页的页码</p>
<p>pageSize：每页显示的条数</p>
</blockquote>
<p>(2) 在查询获取list集合之后，使用<code>PageInfo&lt;T&gt; pageInfo = new PageInfo&lt;&gt;(List&lt;T&gt; list, int navigatePages)</code>获取分页相关数据</p>
<blockquote>
<p>list：分页之后的数据</p>
<p>navigatePages：导航分页的页码数</p>
</blockquote>
<p>(3) 例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PageHelperTest</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * limit index,pageSize</span></span><br><span class="line"><span class="comment">     * index:当前页的起始索引</span></span><br><span class="line"><span class="comment">     * pageSize：每页显示的条数</span></span><br><span class="line"><span class="comment">     * pageNum：当前页的页码</span></span><br><span class="line"><span class="comment">     * index=(pageNum-1)*pageSize</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * 使用MyBatis的分页插件实现分页功能：</span></span><br><span class="line"><span class="comment">     * 1、需要在查询功能之前开启分页</span></span><br><span class="line"><span class="comment">     * PageHelper.startPage(int pageNum, int pageSize);</span></span><br><span class="line"><span class="comment">     * 2、在查询功能之后获取分页相关信息</span></span><br><span class="line"><span class="comment">     * PageInfo&lt;Emp&gt; page = new PageInfo&lt;&gt;(list, 5);</span></span><br><span class="line"><span class="comment">     * list表示分页数据</span></span><br><span class="line"><span class="comment">     * 5表示当前导航分页的数量</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPageHelper</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            InputStream is = Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line">            SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">            SqlSession sqlSession = sqlSessionFactory.openSession(<span class="keyword">true</span>);</span><br><span class="line">            EmpMapper mapper = sqlSession.getMapper(EmpMapper.class);</span><br><span class="line">            <span class="comment">//Page&lt;Object&gt; page = PageHelper.startPage(2, 4);</span></span><br><span class="line">          </span><br><span class="line">            PageHelper.startPage(<span class="number">1</span>, <span class="number">4</span>);		<span class="comment">//开启分页查询，第一个参数是pageNum(当前页的页码)，第二个参数pageSize(每页显示的数据)</span></span><br><span class="line">            List&lt;Emp&gt; list = mapper.selectByExample(<span class="keyword">null</span>);	<span class="comment">//查询所有数据，没有条件，所以为null</span></span><br><span class="line">            PageInfo&lt;Emp&gt; page = <span class="keyword">new</span> PageInfo&lt;&gt;(list, <span class="number">5</span>);	<span class="comment">//设置导航分页的页码数，5表示当前导航分页的数量</span></span><br><span class="line">            <span class="comment">//list.forEach(emp -&gt; System.out.println(emp));		//输出所有的数据，但未进行分页</span></span><br><span class="line">          </span><br><span class="line">            System.out.println(page);	<span class="comment">//输出分页信息，这句只是为了学习才写的</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>控制台输出的信息</p>
<p>SQL语句<code>SELECT count(0) FROM t_emp</code>查询所有。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">DEBUG</span> 05-26 17:56:56,009 Cache Hit Ratio [SQL_CACHE]: 0.0  (LoggingCache.java:60) </span><br><span class="line"><span class="builtin-name">DEBUG</span> 05-26 17:56:56,092 ==&gt;  Preparing: SELECT count(0) <span class="keyword">FROM</span> t_emp  (BaseJdbcLogger.java:137) </span><br><span class="line"><span class="builtin-name">DEBUG</span> 05-26 17:56:56,111 ==&gt; Parameters:   (BaseJdbcLogger.java:137) </span><br><span class="line"><span class="builtin-name">DEBUG</span> 05-26 17:56:56,212 &lt;==      Total: 1  (BaseJdbcLogger.java:137) </span><br><span class="line"><span class="builtin-name">DEBUG</span> 05-26 17:56:56,214 ==&gt;  Preparing: select eid, emp_name, age, sex, email, did <span class="keyword">from</span> t_emp LIMIT ?  (BaseJdbcLogger.java:137) </span><br><span class="line"><span class="builtin-name">DEBUG</span> 05-26 17:56:56,214 ==&gt; Parameters: 4(Integer)  (BaseJdbcLogger.java:137) </span><br><span class="line"><span class="builtin-name">DEBUG</span> 05-26 17:56:56,306 &lt;==      Total: 4  (BaseJdbcLogger.java:137) </span><br><span class="line">PageInfo&#123;<span class="attribute">pageNum</span>=1, <span class="attribute">pageSize</span>=4, <span class="attribute">size</span>=4, <span class="attribute">startRow</span>=1, <span class="attribute">endRow</span>=4, <span class="attribute">total</span>=28, <span class="attribute">pages</span>=7, <span class="attribute">list</span>=Page&#123;<span class="attribute">count</span>=<span class="literal">true</span>, <span class="attribute">pageNum</span>=1, <span class="attribute">pageSize</span>=4, <span class="attribute">startRow</span>=0, <span class="attribute">endRow</span>=4, <span class="attribute">total</span>=28, <span class="attribute">pages</span>=7, <span class="attribute">reasonable</span>=<span class="literal">false</span>, <span class="attribute">pageSizeZero</span>=<span class="literal">false</span>&#125;[Emp&#123;<span class="attribute">eid</span>=1, <span class="attribute">empName</span>=<span class="string">&#x27;admin&#x27;</span>, <span class="attribute">age</span>=22, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;456@qq.com&#x27;</span>, <span class="attribute">did</span>=3&#125;, Emp&#123;<span class="attribute">eid</span>=2, <span class="attribute">empName</span>=<span class="string">&#x27;李四&#x27;</span>, <span class="attribute">age</span>=21, <span class="attribute">sex</span>=<span class="string">&#x27;女&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;234@qq.com&#x27;</span>, <span class="attribute">did</span>=2&#125;, Emp&#123;<span class="attribute">eid</span>=3, <span class="attribute">empName</span>=<span class="string">&#x27;王五&#x27;</span>, <span class="attribute">age</span>=22, <span class="attribute">sex</span>=<span class="string">&#x27;男&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;345@qq.com&#x27;</span>, <span class="attribute">did</span>=3&#125;, Emp&#123;<span class="attribute">eid</span>=4, <span class="attribute">empName</span>=<span class="string">&#x27;赵六&#x27;</span>, <span class="attribute">age</span>=23, <span class="attribute">sex</span>=<span class="string">&#x27;女&#x27;</span>, <span class="attribute">email</span>=<span class="string">&#x27;456@qq.com&#x27;</span>, <span class="attribute">did</span>=1&#125;], <span class="attribute">prePage</span>=0, <span class="attribute">nextPage</span>=2, <span class="attribute">isFirstPage</span>=<span class="literal">true</span>, <span class="attribute">isLastPage</span>=<span class="literal">false</span>, <span class="attribute">hasPreviousPage</span>=<span class="literal">false</span>, <span class="attribute">hasNextPage</span>=<span class="literal">true</span>, <span class="attribute">navigatePages</span>=5, <span class="attribute">navigateFirstPage</span>=1, <span class="attribute">navigateLastPage</span>=5, navigatepageNums=[1, 2, 3, 4, 5]&#125;</span><br></pre></td></tr></table></figure>

<p>输出的分页信息</p>
<p>PageInfo{pageNum=1, pageSize=4, size=4, startRow=1, endRow=4, total=28, pages=7, </p>
<p>list=Page{count=true, pageNum=1, pageSize=4, startRow=0, endRow=4, total=28, pages=7, reasonable=false, pageSizeZero=false}[Emp{eid=1, empName=’admin’, age=22, sex=’男’, email=’456@qq.com’, did=3},<br>Emp{eid=2, empName=’李四’, age=21, sex=’女’, email=’234@qq.com’, did=2},<br>Emp{eid=3, empName=’王五’, age=22, sex=’男’, email=’345@qq.com’, did=3},<br>Emp{eid=4, empName=’赵六’, age=23, sex=’女’, email=’456@qq.com’, did=1}], </p>
<p>prePage=0, nextPage=2, isFirstPage=true, isLastPage=false, hasPreviousPage=false, hasNextPage=true, navigatePages=5, navigateFirstPage=1, navigateLastPage=5, navigatepageNums=[1, 2, 3, 4, 5]}</p>
<p>从分页信息中，可以看出，总共28条数据，共7页。查询到的是第一页，且有4条数据，导航显示的页数范围为[1, 2, 3, 4, 5]</p>
<h4 id="十三、补充"><a href="#十三、补充" class="headerlink" title="十三、补充"></a>十三、补充</h4><h5 id="1、resultMap标签"><a href="#1、resultMap标签" class="headerlink" title="1、resultMap标签"></a>1、resultMap标签</h5><p>MyBatis 中xml的 <code>&lt;resultMap&gt;</code> 标签用于<strong>定义 SQL 查询结果与 Java 对象之间的映射规则</strong>。通过 <code>&lt;resultMap&gt;</code> 标签，我们可以指定如何将查询结果中的列映射到 Java 对象的属性上，以及如何处理查询结果中的嵌套对象。</p>
<p>下面是 <code>&lt;resultMap&gt;</code> 标签的基本语法：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;resultMapId&quot;</span> <span class="attr">type</span>=<span class="string">&quot;resultType&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 定义主键 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 定义普通属性 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 定义关联属性 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;dept&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;deptResultMap&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>其中，<code>id</code> 属性指定了 <code>&lt;resultMap&gt;</code> 的唯一标识符，<code>type</code> 属性指定了 Java 对象的类型，<code>&lt;id&gt;</code> 标签用于指定主键属性的映射规则，<code>&lt;result&gt;</code> 标签用于指定普通属性的映射规则，<code>&lt;association&gt;</code> 标签用于指定关联属性的映射规则，<code>resultMap</code> 属性用于引用另一个 <code>&lt;resultMap&gt;</code>。</p>
<p>在 <code>&lt;resultMap&gt;</code> 中，可以使用 <code>&lt;id&gt;</code>、<code>&lt;result&gt;</code>、<code>&lt;association&gt;</code>、<code>&lt;collection&gt;</code> 等标签来定义属性的映射规则，具体的标签使用方式如下：</p>
<ul>
<li><p>```<br><id>标签：用于定义主键属性的映射规则。</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  - `property` 属性：指定 Java 对象中的主键属性名称。</span><br><span class="line">  - `column` 属性：指定 SQL 查询结果中的主键列名称。</span><br><span class="line"></span><br><span class="line">- ```</span><br><span class="line">  &lt;result&gt;标签：用于定义普通属性的映射规则。</span><br></pre></td></tr></table></figure>

<ul>
<li><code>property</code> 属性：指定 Java 对象中的普通属性名称。</li>
<li><code>column</code> 属性：指定 SQL 查询结果中的列名称。</li>
<li><code>typeHandler</code> 属性：指定类型处理器，用于处理特定类型的数据。</li>
</ul>
</li>
<li><p>```<br><association>标签：用于定义关联属性的映射规则。</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  - `property` 属性：指定 Java 对象中的关联属性名称。</span><br><span class="line">  - `resultMap` 属性：指定关联对象的映射规则。</span><br><span class="line">  - `column` 属性：指定 SQL 查询结果中连接两个表的列名称。</span><br><span class="line">  - `select` 属性：指定关联查询的 SQL 语句。</span><br><span class="line"></span><br><span class="line">- ```</span><br><span class="line">  &lt;collection&gt;标签：用于定义集合属性的映射规则，类似于&lt;association&gt;标签。</span><br></pre></td></tr></table></figure>

<ul>
<li><code>property</code> 属性：指定 Java 对象中的集合属性名称。</li>
<li><code>resultMap</code> 属性：指定集合元素的映射规则。</li>
<li><code>column</code> 属性：指定 SQL 查询结果中连接两个表的列名称。</li>
<li><code>select</code> 属性：指定关联查询的 SQL 语句。</li>
</ul>
</li>
</ul>
<p>除了以上标签外，还可以使用 <code>&lt;constructor&gt;</code> 标签来定义 Java 对象的构造函数参数的映射规则，以及 <code>&lt;discriminator&gt;</code> 标签来处理查询结果中的多态类型。</p>
<h5 id="2、mybayis中resultType有哪些"><a href="#2、mybayis中resultType有哪些" class="headerlink" title="2、mybayis中resultType有哪些"></a>2、mybayis中resultType有哪些</h5><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/codejas/article/details/79520246">https://blog.csdn.net/codejas/article/details/79520246</a></p>
<p>MyBatis 中的 <code>resultType</code> 属性<strong>用于指定 SQL 语句执行后的返回结果类型</strong>。<code>resultType</code> 可以设置为 Java 中的基本数据类型、包装类、自定义 POJO 类型、Map 类型等等。</p>
<p>以下是 MyBatis 中常用的 <code>resultType</code> 类型：</p>
<ul>
<li>基本数据类型和包装类：<code>int</code>、<code>long</code>、<code>double</code>、<code>float</code>、<code>boolean</code> 等；</li>
<li>String 类型：<code>java.lang.String</code>；</li>
<li>Date 类型：<code>java.util.Date</code>、<code>java.sql.Date</code>、<code>java.sql.Time</code>、<code>java.sql.Timestamp</code> 等；</li>
<li>自定义 POJO 类型：对应 Java 中的自定义类，例如 <code>com.example.User</code>；</li>
<li>Map 类型：<code>java.util.Map</code> 或其子类，例如 <code>java.util.HashMap</code>；</li>
<li>List 类型：<code>java.util.List</code> 或其子类，例如 <code>java.util.ArrayList</code>。</li>
</ul>
<p>此外，MyBatis 还支持以别名的方式引用这些类型，例如 <code>_int</code> 表示整数类型、<code>_long</code> 表示长整数类型、<code>_string</code> 表示字符串类型等等。在 MyBatis 的配置文件中，可以定义类型别名来代替 Java 中的数据类型，以简化 XML 配置文件的书写。</p>
<h5 id="3、xml中多个参数时的占位符标准"><a href="#3、xml中多个参数时的占位符标准" class="headerlink" title="3、xml中多个参数时的占位符标准"></a>3、xml中多个参数时的占位符标准</h5><p>（1）若Mapper接口中不使用@Param注解，则编写mapper的xml文件有多个参数时使用<code>&#39;$&#123;param1&#125;&#39;</code>、<code>&#39;$&#123;param2&#125;&#39;</code>或<code>#&#123;arg0&#125;</code>、<code>#&#123;arg1&#125;</code>作为占位符。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//有两个参数</span></span><br><span class="line"><span class="function">User <span class="title">checkLogin</span><span class="params">(String username, String password)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;checkLogin&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--select * from t_user where username = #&#123;arg0&#125; and password = #&#123;arg1&#125;--&gt;</span></span><br><span class="line">    select * from t_user where username = &#x27;$&#123;param1&#125;&#x27; and password = &#x27;$&#123;param2&#125;&#x27;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>（2）若Mapper接口中使用了@Param注解，则不需要</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//有两个参数</span></span><br><span class="line"><span class="function">User <span class="title">checkLoginByParam</span><span class="params">(<span class="meta">@Param(&quot;username&quot;)</span> String username, <span class="meta">@Param(&quot;password&quot;)</span> String password)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;checkLoginByParam&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    select * from t_user where username = #&#123;username&#125; and password = #&#123;password&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="4、mybatis逆向工程和mybatis-plus代码生成器的区别"><a href="#4、mybatis逆向工程和mybatis-plus代码生成器的区别" class="headerlink" title="4、mybatis逆向工程和mybatis plus代码生成器的区别"></a>4、mybatis逆向工程和mybatis plus代码生成器的区别</h5><p><strong>mybatis分页：pageHelper类，mybatis plus分页：PaginationInterceptor类。</strong></p>
<p>MyBatis 逆向工程和 MyBatis Plus 代码生成器<strong>都是用于自动生成数据库表对应的实体类、Mapper 接口以及 XML 文件的工具</strong>，它们的主要区别如下：</p>
<ol>
<li>实现方式不同：MyBatis 逆向工程是 MyBatis 官方提供的工具，需要通过配置 XML 文件来生成代码；而 MyBatis Plus 代码生成器是基于模板引擎实现的代码生成器，可以通过简单的命令行或者图形界面来生成代码。</li>
<li>功能不同：MyBatis 逆向工程可以根据数据库中的表自动生成实体类、Mapper 接口以及 XML 文件，但是不支持生成其他功能代码，如分页、条件查询等；而 MyBatis Plus 代码生成器不仅能够生成基本的实体类、Mapper 接口和 XML 文件，还能够生成常用的查询方法、分页查询、条件构造器等代码，从而简化了开发人员的工作。</li>
<li>集成不同：MyBatis 逆向工程需要手动集成到项目中，需要熟悉其配置方式和使用方法；而 MyBatis Plus 代码生成器是 MyBatis Plus 框架自带的工具，可以直接引入到项目中使用，无需额外的配置和集成。</li>
</ol>
<hr>
<h3 id="MyBatis-Plus"><a href="#MyBatis-Plus" class="headerlink" title="MyBatis Plus"></a>MyBatis Plus</h3><h4 id="1、MyBatisPlus简介"><a href="#1、MyBatisPlus简介" class="headerlink" title="1、MyBatisPlus简介"></a>1、MyBatisPlus简介</h4><h5 id="1-1、概述"><a href="#1-1、概述" class="headerlink" title="1.1、概述"></a>1.1、概述</h5><p>官网：<a target="_blank" rel="noopener" href="https://baomidou.com/">https://baomidou.com/</a><br><a target="_blank" rel="noopener" href="https://github.com/baomidou/mybatis-plus">MyBatis-Plus</a>（简称 MP）是一个 <a target="_blank" rel="noopener" href="http://www.mybatis.org/mybatis-3/">MyBatis</a> 的增强工具，在 MyBatis 的基础上只做增强不做改变，为简化开发、提高效率而生。</p>
<h5 id="1-2、特性"><a href="#1-2、特性" class="headerlink" title="1.2、特性"></a>1.2、特性</h5><ul>
<li><strong>无侵入</strong>：只做增强不做改变，引入它不会对现有工程产生影响，如丝般顺滑</li>
<li><strong>损耗小</strong>：启动即会自动注入基本 CURD，性能基本无损耗，直接面向对象操作</li>
<li><strong>强大的 CRUD 操作</strong>：内置通用 Mapper、通用 Service，仅仅通过少量配置即可实现单表大部分 CRUD 操作，更有强大的条件构造器，满足各类使用需求</li>
<li><strong>支持 Lambda 形式调用</strong>：通过 Lambda 表达式，方便的编写各类查询条件，无需再担心字段写错</li>
<li><strong>支持多种数据库</strong>：支持 MySQL、MariaDB、Oracle、DB2、H2、HSQL、SQLite、Postgre、SQLServer2005、SQLServer 等多种数据库</li>
<li><strong>支持主键自动生成</strong>：支持多达 4 种主键策略（内含分布式唯一 ID 生成器 - Sequence），可自由配置，完美解决主键问题</li>
<li><strong>支持 XML 热加载</strong>：Mapper 对应的 XML 支持热加载，对于简单的 CRUD 操作，甚至可以无 XML 启动</li>
<li><strong>支持 ActiveRecord 模式</strong>：支持 ActiveRecord 形式调用，实体类只需继承 Model 类即可进行强大的 CRUD 操作</li>
<li><strong>支持自定义全局通用操作</strong>：支持全局通用方法注入（ Write once, use anywhere ）</li>
<li><strong>支持关键词自动转义</strong>：支持数据库关键词（order、key……）自动转义，还可自定义关键词</li>
<li><strong>内置代码生成器</strong>：采用代码或者 Maven 插件可快速生成 Mapper 、 Model 、 Service 、 Controller 层代码，支持模板引擎，更有超多自定义配置等您来使用</li>
<li><strong>内置分页插件</strong>：基于 MyBatis 物理分页，开发者无需关心具体操作，配置好插件之后，写分页等同于普通 List 查询</li>
<li><strong>内置性能分析插件</strong>：可输出 Sql 语句以及其执行时间，建议开发测试时启用该功能，能快速揪出慢查询</li>
<li><strong>内置全局拦截插件</strong>：提供全表 delete 、 update 操作智能分析阻断，也可自定义拦截规则，预防误操作</li>
<li><strong>内置 Sql 注入剥离器</strong>：支持 Sql 注入剥离，有效预防 Sql 注入攻击</li>
</ul>
<h4 id="2、MyBatisPlus入门"><a href="#2、MyBatisPlus入门" class="headerlink" title="2、MyBatisPlus入门"></a>2、MyBatisPlus入门</h4><img src="https://raw.githubusercontent.com/yagote/blog-image/master/202310021103677.png" alt="image-20220412114912797" style="zoom:67%;" />

<h5 id="2-1、创建测试数据库和表"><a href="#2-1、创建测试数据库和表" class="headerlink" title="2.1、创建测试数据库和表"></a>2.1、创建测试数据库和表</h5><p><strong>mybatis_plus</strong></p>
<p>其表结构如下：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>age</th>
<th>email</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>Jone</td>
<td>18</td>
<td><a href="mailto:&#x74;&#x65;&#x73;&#x74;&#49;&#x40;&#x62;&#x61;&#111;&#109;&#x69;&#x64;&#x6f;&#x75;&#46;&#x63;&#x6f;&#x6d;">&#x74;&#x65;&#x73;&#x74;&#49;&#x40;&#x62;&#x61;&#111;&#109;&#x69;&#x64;&#x6f;&#x75;&#46;&#x63;&#x6f;&#x6d;</a></td>
</tr>
<tr>
<td>2</td>
<td>Jack</td>
<td>20</td>
<td><a href="mailto:&#x74;&#x65;&#x73;&#x74;&#50;&#x40;&#98;&#97;&#x6f;&#x6d;&#x69;&#x64;&#111;&#x75;&#46;&#99;&#111;&#x6d;">&#x74;&#x65;&#x73;&#x74;&#50;&#x40;&#98;&#97;&#x6f;&#x6d;&#x69;&#x64;&#111;&#x75;&#46;&#99;&#111;&#x6d;</a></td>
</tr>
<tr>
<td>3</td>
<td>Tom</td>
<td>28</td>
<td><a href="mailto:&#116;&#101;&#115;&#116;&#x33;&#x40;&#x62;&#97;&#111;&#x6d;&#x69;&#100;&#x6f;&#x75;&#46;&#x63;&#111;&#109;">&#116;&#101;&#115;&#116;&#x33;&#x40;&#x62;&#97;&#111;&#x6d;&#x69;&#100;&#x6f;&#x75;&#46;&#x63;&#111;&#109;</a></td>
</tr>
<tr>
<td>4</td>
<td>Sandy</td>
<td>21</td>
<td><a href="mailto:&#116;&#x65;&#115;&#116;&#x34;&#64;&#98;&#x61;&#x6f;&#x6d;&#105;&#100;&#111;&#x75;&#x2e;&#x63;&#x6f;&#x6d;">&#116;&#x65;&#115;&#116;&#x34;&#64;&#98;&#x61;&#x6f;&#x6d;&#105;&#100;&#111;&#x75;&#x2e;&#x63;&#x6f;&#x6d;</a></td>
</tr>
<tr>
<td>5</td>
<td>Billie</td>
<td>24</td>
<td><a href="mailto:&#116;&#x65;&#115;&#116;&#53;&#64;&#x62;&#97;&#111;&#x6d;&#x69;&#100;&#x6f;&#117;&#x2e;&#x63;&#x6f;&#109;">&#116;&#x65;&#115;&#116;&#53;&#64;&#x62;&#97;&#111;&#x6d;&#x69;&#100;&#x6f;&#117;&#x2e;&#x63;&#x6f;&#109;</a></td>
</tr>
</tbody></table>
<p>其对应的建表语句如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">user</span></span><br><span class="line">(</span><br><span class="line">    id <span class="type">BIGINT</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;主键ID&#x27;</span>,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    age <span class="type">INT</span>(<span class="number">11</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;年龄&#x27;</span>,</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;邮箱&#x27;</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>其对应的数据库 Data 脚本如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">user</span> (id, name, age, email) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">1</span>, <span class="string">&#x27;Jone&#x27;</span>, <span class="number">18</span>, <span class="string">&#x27;test1@baomidou.com&#x27;</span>),</span><br><span class="line">(<span class="number">2</span>, <span class="string">&#x27;Jack&#x27;</span>, <span class="number">20</span>, <span class="string">&#x27;test2@baomidou.com&#x27;</span>),</span><br><span class="line">(<span class="number">3</span>, <span class="string">&#x27;Tom&#x27;</span>, <span class="number">28</span>, <span class="string">&#x27;test3@baomidou.com&#x27;</span>),</span><br><span class="line">(<span class="number">4</span>, <span class="string">&#x27;Sandy&#x27;</span>, <span class="number">21</span>, <span class="string">&#x27;test4@baomidou.com&#x27;</span>),</span><br><span class="line">(<span class="number">5</span>, <span class="string">&#x27;Billie&#x27;</span>, <span class="number">24</span>, <span class="string">&#x27;test5@baomidou.com&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h5 id="2-2、创建项目和添加依赖"><a href="#2-2、创建项目和添加依赖" class="headerlink" title="2.2、创建项目和添加依赖"></a>2.2、创建项目和添加依赖</h5><p><strong>（1）使用 Spring Initializr 初始化 Spring Boot 工程</strong></p>
<p>Group：com.atguigu</p>
<p>Artifact：mybatis-plus</p>
<p>版本：2.2.1.RELEASE</p>
<p><strong>（2）项目引入依赖</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--mybatis-plus--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--mysql--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--lombok用来简化实体类--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>（3）idea中安装lombok插件</strong></p>
<img src="https://raw.githubusercontent.com/yagote/blog-image/master/202310021103678.png" alt="image-20230517175558790" style="zoom:80%;" />

<h5 id="2-3、创建配置文件"><a href="#2-3、创建配置文件" class="headerlink" title="2.3、创建配置文件"></a>2.3、创建配置文件</h5><p><strong>mysql5</strong></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#mysql数据库连接</span></span><br><span class="line"><span class="meta">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string">jdbc:mysql://localhost:3306/mybatis_plus</span></span><br><span class="line"><span class="meta">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.datasource.password</span>=<span class="string">123456</span></span><br></pre></td></tr></table></figure>

<p><strong>mysql8以上（spring boot 2.1）注意：driver和url的变化</strong></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string">jdbc:mysql://localhost:3306/mybatis_plus?serverTimezone=GMT%2B8</span></span><br><span class="line"><span class="meta">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.datasource.password</span>=<span class="string">root</span></span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong></p>
<p>1、这里的 url 使用了 ?serverTimezone=GMT%2B8 后缀，因为Spring Boot 2.1 集成了 8.0版本的jdbc驱动，这个版本的 jdbc 驱动需要添加这个后缀，否则运行测试用例报告如下错误：</p>
<p>java.sql.SQLException: The server time zone value ‘ÖÐ¹ú±ê×¼Ê±¼ä’ is unrecognized or represents more </p>
<p>2、这里的 driver-class-name 使用了 com.mysql.cj.jdbc.Driver ，在 jdbc 8 中 建议使用这个驱动，之前的 com.mysql.jdbc.Driver 已经被废弃，否则运行测试用例的时候会有 WARN 信息</p>
<h5 id="2-4、编写代码"><a href="#2-4、编写代码" class="headerlink" title="2.4、编写代码"></a>2.4、编写代码</h5><p><strong>（1）创建启动类</strong></p>
<p>在 Spring Boot 启动类中添加 <code>@MapperScan</code> 注解，扫描 Mapper 文件夹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;com.atguigu.mybatisplus.mapper&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisPlusApplication</span> </span>&#123;</span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>（2）创建实体类</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>（3）创建Mapper</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>（4）功能测试-查询所有记录</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisPlusApplicationTests</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println((<span class="string">&quot;----- selectAll method test ------&quot;</span>));</span><br><span class="line">        <span class="comment">//UserMapper 中的 selectList() 方法的参数为 MP 内置的条件封装器 Wrapper</span></span><br><span class="line">        <span class="comment">//所以不填写就是无任何条件</span></span><br><span class="line">        List&lt;User&gt; users = userMapper.selectList(<span class="keyword">null</span>);</span><br><span class="line">        users.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong></p>
<p>IDEA在 userMapper 处报错，因为找不到注入的对象，因为类是动态创建的，但是程序可以正确的执行。</p>
<p>为了避免报错，可以在 dao 层 的接口上添加 @Repository 注解。通过使用 @Repository 注解，Spring 可以自动扫描并将 DAO 类注册为 Spring 的 Bean，并且可以在需要访问数据时，通过注入 DAO 类来进行数据访问操作。</p>
<h4 id="3、MyBatisPlus实现CRUD操作"><a href="#3、MyBatisPlus实现CRUD操作" class="headerlink" title="3、MyBatisPlus实现CRUD操作"></a>3、MyBatisPlus实现CRUD操作</h4><h5 id="3-1、插入操作"><a href="#3-1、插入操作" class="headerlink" title="3.1、插入操作"></a>3.1、插入操作</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CRUDTests</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsert</span><span class="params">()</span></span>&#123;</span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setName(<span class="string">&quot;mary&quot;</span>);</span><br><span class="line">        user.setAge(<span class="number">18</span>);</span><br><span class="line">        user.setEmail(<span class="string">&quot;atguigu@qq.com&quot;</span>);</span><br><span class="line">        <span class="keyword">int</span> result = userMapper.insert(user);</span><br><span class="line">        System.out.println(result); <span class="comment">//影响的行数</span></span><br><span class="line">        System.out.println(user); <span class="comment">//id自动回填</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong>数据库插入id值默认为：全局唯一id</p>
<img src="https://raw.githubusercontent.com/yagote/blog-image/master/202310021103679.jpg" style="zoom:80%;" />

<p><strong>查看sql输出日志</strong></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#mybatis日志</span></span><br><span class="line"><span class="meta">mybatis-plus.configuration.log-impl</span>=<span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br></pre></td></tr></table></figure>



<h5 id="3-2、主键策略"><a href="#3-2、主键策略" class="headerlink" title="3.2、主键策略"></a>3.2、主键策略</h5><p><strong>（1）ID_WORKER</strong></p>
<p>MyBatis-Plus默认的主键策略是：ID_WORKER  <em>全局唯一ID</em></p>
<p><strong>（2）自增策略</strong></p>
<ul>
<li><p>要想主键自增需要配置如下主键策略</p>
</li>
<li><ul>
<li>需要在创建数据表的时候设置主键自增</li>
<li>实体字段中配置 @TableId(type = IdType.AUTO)</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@TableId(type = IdType.AUTO)</span></span><br><span class="line"><span class="keyword">private</span> Long id;</span><br></pre></td></tr></table></figure>

<p>其它主键策略：分析 IdType 源码可知</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">IdType</span> </span>&#123;</span><br><span class="line">     <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 数据库ID自增</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    AUTO(<span class="number">0</span>),</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 该类型为未设置主键类型</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    NONE(<span class="number">1</span>),</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 用户输入ID</span></span><br><span class="line"><span class="comment">     * 该类型可以通过自己注册自动填充插件进行填充</span></span><br><span class="line"><span class="comment">     */</span>    </span><br><span class="line">    INPUT(<span class="number">2</span>),</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 全局唯一ID</span></span><br><span class="line"><span class="comment">     */</span>    </span><br><span class="line">    ASSIGN_ID(<span class="number">3</span>),</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 全局唯一ID (UUID)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    ASSIGN_UUID(<span class="number">4</span>),</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** <span class="doctag">@deprecated</span> */</span></span><br><span class="line">    <span class="meta">@Deprecated</span></span><br><span class="line">    ID_WORKER(<span class="number">3</span>),</span><br><span class="line">    <span class="comment">/** <span class="doctag">@deprecated</span> */</span></span><br><span class="line">    <span class="meta">@Deprecated</span></span><br><span class="line">    ID_WORKER_STR(<span class="number">3</span>),</span><br><span class="line">    <span class="comment">/** <span class="doctag">@deprecated</span> */</span></span><br><span class="line">    <span class="meta">@Deprecated</span></span><br><span class="line">    UUID(<span class="number">4</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> key;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">IdType</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.key = key;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.key;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="3-3、根据Id更新操作"><a href="#3-3、根据Id更新操作" class="headerlink" title="3.3、根据Id更新操作"></a>3.3、根据Id更新操作</h5><p><strong>注意：</strong>update时生成的sql自动是动态sql：UPDATE user SET age=? WHERE id=? </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdateById</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//1 根据id查询记录</span></span><br><span class="line">    User user = userMapper.selectById(<span class="number">1L</span>);</span><br><span class="line">    <span class="comment">//2 设置修改的值</span></span><br><span class="line">    user.setAge(<span class="number">50</span>);</span><br><span class="line">    <span class="comment">//3 调用方法修改</span></span><br><span class="line">    <span class="keyword">int</span> result = userMapper.updateById(user);</span><br><span class="line">    System.out.println(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="3-4、分页查询"><a href="#3-4、分页查询" class="headerlink" title="3.4、分页查询"></a>3.4、分页查询</h5><p>MyBatis Plus自带分页插件，只要简单的配置即可实现分页功能</p>
<p><strong>（1）创建配置类</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 分页插件</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> PaginationInterceptor <span class="title">paginationInterceptor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> PaginationInterceptor();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>（2）测试selectPage分页</strong></p>
<p><strong>测试：</strong>最终通过page对象获取相关数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectPage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Page&lt;User&gt; page = <span class="keyword">new</span> Page&lt;&gt;(<span class="number">1</span>,<span class="number">5</span>);</span><br><span class="line">    userMapper.selectPage(page, <span class="keyword">null</span>);</span><br><span class="line">    page.getRecords().forEach(System.out::println);</span><br><span class="line">    System.out.println(page.getCurrent());</span><br><span class="line">    System.out.println(page.getPages());</span><br><span class="line">    System.out.println(page.getSize());</span><br><span class="line">    System.out.println(page.getTotal());</span><br><span class="line">    System.out.println(page.hasNext());</span><br><span class="line">    System.out.println(page.hasPrevious());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>控制台sql语句打印：SELECT id,name,age,email,create_time,update_time FROM user LIMIT 0,5 </p>
<h5 id="3-5、根据id删除记录"><a href="#3-5、根据id删除记录" class="headerlink" title="3.5、根据id删除记录"></a>3.5、根据id删除记录</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteById</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> result = userMapper.deleteById(<span class="number">8L</span>);</span><br><span class="line">    System.out.println(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="3-6、批量删除"><a href="#3-6、批量删除" class="headerlink" title="3.6、批量删除"></a>3.6、批量删除</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteBatchIds</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> result = userMapper.deleteBatchIds(Arrays.asList(<span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>));</span><br><span class="line">    System.out.println(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="3-7、逻辑删除"><a href="#3-7、逻辑删除" class="headerlink" title="3.7、逻辑删除"></a>3.7、逻辑删除</h5><ul>
<li>物理删除：真实删除，将对应数据从数据库中删除，之后查询不到此条被删除数据</li>
<li>逻辑删除：假删除，将对应数据中代表是否被删除字段状态修改为“被删除状态”，之后在数据库中仍旧能看到此条数据记录</li>
</ul>
<p><strong>（1）数据库中添加 deleted字段</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE `user` ADD COLUMN `deleted` boolean</span><br></pre></td></tr></table></figure>

<p><strong>（2）实体类添加deleted字段</strong></p>
<p>并加上 @TableLogic 注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@TableLogic</span></span><br><span class="line"><span class="keyword">private</span> Integer deleted;</span><br></pre></td></tr></table></figure>

<p><strong>（3）application.properties 加入配置</strong></p>
<p>此为默认值，如果你的默认值和mp默认的一样,该配置可无</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mybatis-plus.global-config.db-config.logic-delete-value</span>=<span class="string">1</span></span><br><span class="line"><span class="meta">mybatis-plus.global-config.db-config.logic-not-delete-value</span>=<span class="string">0</span></span><br></pre></td></tr></table></figure>

<p><strong>（5）测试逻辑删除</strong></p>
<ul>
<li>测试后发现，数据并没有被删除，deleted字段的值由0变成了1</li>
<li>测试后分析打印的sql语句，是一条update</li>
<li><strong>注意：</strong>被删除数据的deleted 字段的值必须是 0，才能被选取出来执行逻辑删除的操作</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试 逻辑删除</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testLogicDelete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> result = userMapper.deleteById(<span class="number">1L</span>);</span><br><span class="line">    System.out.println(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>（7）测试逻辑删除后的查询</strong></p>
<p>MyBatis Plus中查询操作也会自动添加逻辑删除字段的判断</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试 逻辑删除后的查询：</span></span><br><span class="line"><span class="comment"> * 不包括被逻辑删除的记录</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testLogicDeleteSelect</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    User user = <span class="keyword">new</span> User();</span><br><span class="line">    List&lt;User&gt; users = userMapper.selectList(<span class="keyword">null</span>);</span><br><span class="line">    users.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试后分析打印的sql语句，包含 WHERE deleted=0 </p>
<p>SELECT id,name,age,email,create_time,update_time,deleted FROM user WHERE deleted=0</p>
<h4 id="4、MyBatisPlus条件构造器"><a href="#4、MyBatisPlus条件构造器" class="headerlink" title="4、MyBatisPlus条件构造器"></a>4、MyBatisPlus条件构造器</h4><p><a target="_blank" rel="noopener" href="https://baomidou.com/pages/10c804/#abstractwrapper">https://baomidou.com/pages/10c804/#abstractwrapper</a></p>
<p><img src="https://raw.githubusercontent.com/yagote/blog-image/master/202310021103680.png"></p>
<p>Wrapper ： 条件构造抽象类，最顶端父类</p>
<p>  AbstractWrapper ： 用于查询条件封装，生成 sql 的 where 条件</p>
<p>​    QueryWrapper ： Entity 对象封装操作类，不是用lambda语法</p>
<p>​    UpdateWrapper ： Update 条件封装，用于Entity对象更新操作</p>
<p>  AbstractLambdaWrapper ： Lambda 语法使用 Wrapper统一处理解析 lambda 获取 column。</p>
<p>​    LambdaQueryWrapper ：看名称也能明白就是用于Lambda语法使用的查询Wrapper</p>
<p>​    LambdaUpdateWrapper ： Lambda 更新封装Wrapper</p>
<p><strong>注意：以下条件构造器的方法入参中的 <code>column </code>均表示数据库字段</strong></p>
<h5 id="4-1、QueryWrapper-使用"><a href="#4-1、QueryWrapper-使用" class="headerlink" title="4.1、QueryWrapper 使用"></a>4.1、QueryWrapper 使用</h5><p><strong>（1）ge大于等于、gt大于、le小于等于、lt小于</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelect</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    QueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">    queryWrapper.ge(<span class="string">&quot;age&quot;</span>, <span class="number">28</span>);</span><br><span class="line">    List&lt;User&gt; users = userMapper.selectList(queryWrapper);</span><br><span class="line">    System.out.println(users);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>（2）eq等于、ne不等于&lt;&gt;</strong></p>
<p><strong>注意：</strong>seletOne返回的是一条实体记录，当出现多条时会报错</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectOne</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    QueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">    queryWrapper.eq(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;Tom&quot;</span>);</span><br><span class="line">    User user = userMapper.selectOne(queryWrapper);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>SELECT id,name,age,email,create_time,update_time,deleted,version FROM user WHERE deleted=0 AND name = ? </p>
<p><strong>（3）like、likeLeft、likeRight</strong> </p>
<p>selectMaps返回Map集合列表</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectMaps</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    QueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">    queryWrapper</span><br><span class="line">        .like(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;e&quot;</span>)</span><br><span class="line">        .likeRight(<span class="string">&quot;email&quot;</span>, <span class="string">&quot;t&quot;</span>);</span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; maps = userMapper.selectMaps(queryWrapper);<span class="comment">//返回值是Map列表</span></span><br><span class="line">    maps.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>SELECT id,name,age,email,create_time,update_time,deleted,version </p>
<p>FROM user WHERE deleted=0 AND name LIKE ? AND email LIKE ? </p>
<p><strong>（4）orderByDesc、orderByAsc</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectListOrderBy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    QueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">    queryWrapper.orderByDesc(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">    List&lt;User&gt; users = userMapper.selectList(queryWrapper);</span><br><span class="line">    users.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>SELECT id,name,age,email,create_time,update_time,deleted,version </p>
<p>FROM user WHERE deleted=0 ORDER BY id DESC </p>
<h5 id="4-2、LambdaQueryWrapper-使用"><a href="#4-2、LambdaQueryWrapper-使用" class="headerlink" title="4.2、LambdaQueryWrapper  使用"></a>4.2、LambdaQueryWrapper  使用</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testLambdaQuery</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    LambdaQueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> LambdaQueryWrapper&lt;&gt;();</span><br><span class="line">    queryWrapper.eq(User::getAge,<span class="number">30</span>);</span><br><span class="line">    queryWrapper.like(User::getName,<span class="string">&quot;张&quot;</span>);</span><br><span class="line">    List&lt;User&gt; list = userMapper.selectList(queryWrapper);</span><br><span class="line">    System.out.println(list);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>SELECT id,name,age,email,create_time,update_time,deleted,version </p>
<p>FROM user WHERE deleted=0 AND age = ? AND name LIKE ?</p>
<h4 id="5、MyBatisPlus封装Service层"><a href="#5、MyBatisPlus封装Service层" class="headerlink" title="5、MyBatisPlus封装Service层"></a>5、MyBatisPlus封装Service层</h4><h5 id="5-1、创建service"><a href="#5-1、创建service" class="headerlink" title="5.1、创建service"></a>5.1、创建service</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> <span class="keyword">extends</span> <span class="title">IService</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="5-2、创建service实现类"><a href="#5-2、创建service实现类" class="headerlink" title="5.2、创建service实现类"></a>5.2、创建service实现类</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">extends</span> <span class="title">ServiceImpl</span>&lt;<span class="title">UserMapper</span>, <span class="title">User</span>&gt; <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">&#125;	<span class="comment">//User是对应的实体类</span></span><br></pre></td></tr></table></figure>

<p><strong>底层封装了注入Mapper过程</strong></p>
<p><img src="https://raw.githubusercontent.com/yagote/blog-image/master/202310021103681.png" alt="image-20220412115210448"></p>
<h5 id="5-3、方法调用测试"><a href="#5-3、方法调用测试" class="headerlink" title="5.3、方法调用测试"></a>5.3、方法调用测试</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestApplicationTests</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//注入service</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//查询表所有数据</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;User&gt; userList = userService.list();</span><br><span class="line">        <span class="keyword">for</span> (User user:userList) &#123;</span><br><span class="line">            System.out.println(user);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://yagote.github.io">虾壳</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://yagote.github.io/2023/10/02/mybatis/">http://yagote.github.io/2023/10/02/mybatis/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yagote.github.io" target="_blank">虾壳</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%95%99%E7%A8%8B/">教程</a><a class="post-meta__tags" href="/tags/MyBatis/">MyBatis</a><a class="post-meta__tags" href="/tags/MyBatis-Plus/">MyBatis Plus</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2023/10/01/springmvc/" title="SpringMVC"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">SpringMVC</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/08/08/spring-data-jpa/" title="Spring Data JPA"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-08</div><div class="title">Spring Data JPA</div></div></a></div><div><a href="/2023/10/01/axios/" title="Axios"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-01</div><div class="title">Axios</div></div></a></div><div><a href="/2023/10/01/css/" title="CSS"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-01</div><div class="title">CSS</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E7%AE%80%E4%BB%8B"><span class="toc-text">一、简介</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81MyBatis%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-text">1、MyBatis是什么</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E5%92%8C%E5%85%B6%E5%AE%83%E6%8C%81%E4%B9%85%E5%8C%96%E5%B1%82%E6%8A%80%E6%9C%AF%E5%AF%B9%E6%AF%94"><span class="toc-text">2、和其它持久化层技术对比</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%90%AD%E5%BB%BAMyBatis"><span class="toc-text">二、搭建MyBatis</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%88%9B%E5%BB%BAmaven%E5%B7%A5%E7%A8%8B"><span class="toc-text">1、创建maven工程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E9%85%8D%E7%BD%AE"><span class="toc-text">2、配置</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#2-1-pom-xml%E9%85%8D%E7%BD%AE"><span class="toc-text">2.1 pom.xml配置</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-2-mybatis-config-xml%E9%85%8D%E7%BD%AE"><span class="toc-text">2.2 mybatis-config.xml配置</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E6%A0%B8%E5%BF%83%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3"><span class="toc-text">三、核心配置文件详解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%9B%E3%80%81MyBatis%E7%9A%84%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5"><span class="toc-text">四、MyBatis的增删改查</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E6%B7%BB%E5%8A%A0"><span class="toc-text">1、添加</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E4%BF%AE%E6%94%B9"><span class="toc-text">2、修改</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E5%88%A0%E9%99%A4"><span class="toc-text">3、删除</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81%E6%9F%A5%E8%AF%A2%E5%8D%95%E4%B8%AA"><span class="toc-text">4、查询单个</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5%E3%80%81%E6%9F%A5%E8%AF%A2%E6%89%80%E6%9C%89"><span class="toc-text">5、查询所有</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%94%E3%80%81MyBatis%E8%8E%B7%E5%8F%96%E5%8F%82%E6%95%B0%E5%80%BC%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F%EF%BC%88%E9%87%8D%E7%82%B9%EF%BC%89"><span class="toc-text">五、MyBatis获取参数值的两种方式（重点）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%8D%95%E4%B8%AA%E5%AD%97%E9%9D%A2%E9%87%8F%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%8F%82%E6%95%B0"><span class="toc-text">1、单个字面量类型的参数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E5%A4%9A%E4%B8%AA%E5%AD%97%E9%9D%A2%E9%87%8F%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%8F%82%E6%95%B0"><span class="toc-text">&#x3D;&#x3D;2、多个字面量类型的参数&#x3D;&#x3D;</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81map%E9%9B%86%E5%90%88%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%8F%82%E6%95%B0"><span class="toc-text">3、map集合类型的参数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81%E5%AE%9E%E4%BD%93%E7%B1%BB%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%8F%82%E6%95%B0"><span class="toc-text">4、实体类类型的参数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5%E3%80%81%E4%BD%BF%E7%94%A8-Param%E6%A0%87%E8%AF%86%E5%8F%82%E6%95%B0"><span class="toc-text">&#x3D;&#x3D;5、使用@Param标识参数&#x3D;&#x3D;</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%AD%E3%80%81MyBatis%E7%9A%84%E5%90%84%E7%A7%8D%E6%9F%A5%E8%AF%A2%E5%8A%9F%E8%83%BD"><span class="toc-text">六、MyBatis的各种查询功能</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E6%9F%A5%E8%AF%A2%E4%B8%80%E4%B8%AA%E5%AE%9E%E4%BD%93%E7%B1%BB%E5%AF%B9%E8%B1%A1"><span class="toc-text">1、查询一个实体类对象</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E6%9F%A5%E8%AF%A2%E4%B8%80%E4%B8%AAlist%E9%9B%86%E5%90%88"><span class="toc-text">2、查询一个list集合</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E6%9F%A5%E8%AF%A2%E5%8D%95%E4%B8%AA%E6%95%B0%E6%8D%AE"><span class="toc-text">3、查询单个数据</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81%E6%9F%A5%E8%AF%A2%E4%B8%80%E6%9D%A1%E6%95%B0%E6%8D%AE%E4%B8%BAmap%E9%9B%86%E5%90%88"><span class="toc-text">4、查询一条数据为map集合</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5%E3%80%81%E6%9F%A5%E8%AF%A2%E5%A4%9A%E6%9D%A1%E6%95%B0%E6%8D%AE%E4%B8%BAmap%E9%9B%86%E5%90%88"><span class="toc-text">5、查询多条数据为map集合</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E7%89%B9%E6%AE%8ASQL%E7%9A%84%E6%89%A7%E8%A1%8C"><span class="toc-text">七、特殊SQL的执行</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2"><span class="toc-text">1、模糊查询</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E6%89%B9%E9%87%8F%E5%88%A0%E9%99%A4"><span class="toc-text">2、批量删除</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E5%8A%A8%E6%80%81%E8%AE%BE%E7%BD%AE%E8%A1%A8%E5%90%8D"><span class="toc-text">3、动态设置表名</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81%E6%B7%BB%E5%8A%A0%E5%8A%9F%E8%83%BD%E8%8E%B7%E5%8F%96%E8%87%AA%E5%A2%9E%E7%9A%84%E4%B8%BB%E9%94%AE"><span class="toc-text">4、添加功能获取自增的主键</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E6%98%A0%E5%B0%84resultMap"><span class="toc-text">八、自定义映射resultMap</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%AD%97%E6%AE%B5%E5%90%8D%E5%92%8C%E5%B1%9E%E6%80%A7%E5%90%8D%E4%B8%8D%E4%B8%80%E8%87%B4"><span class="toc-text">1、字段名和属性名不一致</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80"><span class="toc-text">方法一</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C"><span class="toc-text">方法二</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%89"><span class="toc-text">方法三</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E5%A4%9A%E5%AF%B9%E4%B8%80%E6%98%A0%E5%B0%84%E5%A4%84%E7%90%86"><span class="toc-text">2、多对一映射处理</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#2-1-%E7%BA%A7%E8%81%94%E6%96%B9%E5%BC%8F"><span class="toc-text">2.1 级联方式</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-2-association%E6%96%B9%E5%BC%8F"><span class="toc-text">2.2 association方式</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-3-%E5%88%86%E6%AD%A5%E6%9F%A5%E8%AF%A2"><span class="toc-text">2.3 分步查询</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E4%B8%80%E5%AF%B9%E5%A4%9A%E6%98%A0%E5%B0%84%E5%A4%84%E7%90%86"><span class="toc-text">3、一对多映射处理</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#3-1-collection"><span class="toc-text">3.1 collection</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-%E5%88%86%E6%AD%A5%E6%9F%A5%E8%AF%A2"><span class="toc-text">3.2 分步查询</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B9%9D%E3%80%81%E5%8A%A8%E6%80%81SQL"><span class="toc-text">九、动态SQL</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81if"><span class="toc-text">1、if</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81where"><span class="toc-text">2、where</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81trim"><span class="toc-text">3、trim</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81choose%E3%80%81when%E3%80%81otherwise"><span class="toc-text">4、choose、when、otherwise</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5%E3%80%81foreach"><span class="toc-text">5、foreach</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#5-1-%E9%80%9A%E8%BF%87%E6%95%B0%E7%BB%84%E5%AE%9E%E7%8E%B0%E6%89%B9%E9%87%8F%E5%88%A0%E9%99%A4"><span class="toc-text">5.1 通过数组实现批量删除</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#5-2-%E9%80%9A%E8%BF%87list%E9%9B%86%E5%90%88%E5%AE%9E%E7%8E%B0%E6%89%B9%E9%87%8F%E6%B7%BB%E5%8A%A0"><span class="toc-text">5.2 通过list集合实现批量添加</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6%E3%80%81SQL%E7%89%87%E6%AE%B5"><span class="toc-text">6、SQL片段</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%81%E3%80%81MyBatis%E7%9A%84%E7%BC%93%E5%AD%98"><span class="toc-text">十、MyBatis的缓存</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81MyBatis%E7%9A%84%E4%B8%80%E7%BA%A7%E7%BC%93%E5%AD%98"><span class="toc-text">1、MyBatis的一级缓存</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81MyBatis%E7%9A%84%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98"><span class="toc-text">2、MyBatis的二级缓存</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98%E7%9A%84%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE"><span class="toc-text">3、二级缓存的相关配置</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81MyBatis%E7%BC%93%E5%AD%98%E6%9F%A5%E8%AF%A2%E7%9A%84%E9%A1%BA%E5%BA%8F"><span class="toc-text">4、MyBatis缓存查询的顺序</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5%E3%80%81%E6%95%B4%E5%90%88%E7%AC%AC%E4%B8%89%E6%96%B9%E7%BC%93%E5%AD%98EHCache"><span class="toc-text">5、整合第三方缓存EHCache</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%81%E4%B8%80%E3%80%81MyBatis%E7%9A%84%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B"><span class="toc-text">十一、MyBatis的逆向工程</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%88%9B%E5%BB%BA%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E7%9A%84%E6%AD%A5%E9%AA%A4"><span class="toc-text">1、创建逆向工程的步骤</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81QBC%E6%9F%A5%E8%AF%A2"><span class="toc-text">2、QBC查询</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%81%E4%BA%8C%E3%80%81%E5%88%86%E9%A1%B5%E6%8F%92%E4%BB%B6"><span class="toc-text">十二、分页插件</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%88%86%E9%A1%B5%E6%8F%92%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4"><span class="toc-text">1、分页插件使用步骤</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E5%88%86%E9%A1%B5%E6%8F%92%E4%BB%B6%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">2、分页插件的使用</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%81%E4%B8%89%E3%80%81%E8%A1%A5%E5%85%85"><span class="toc-text">十三、补充</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81resultMap%E6%A0%87%E7%AD%BE"><span class="toc-text">1、resultMap标签</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81mybayis%E4%B8%ADresultType%E6%9C%89%E5%93%AA%E4%BA%9B"><span class="toc-text">2、mybayis中resultType有哪些</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81xml%E4%B8%AD%E5%A4%9A%E4%B8%AA%E5%8F%82%E6%95%B0%E6%97%B6%E7%9A%84%E5%8D%A0%E4%BD%8D%E7%AC%A6%E6%A0%87%E5%87%86"><span class="toc-text">3、xml中多个参数时的占位符标准</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81mybatis%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E5%92%8Cmybatis-plus%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90%E5%99%A8%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">4、mybatis逆向工程和mybatis plus代码生成器的区别</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MyBatis-Plus"><span class="toc-text">MyBatis Plus</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81MyBatisPlus%E7%AE%80%E4%BB%8B"><span class="toc-text">1、MyBatisPlus简介</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1%E3%80%81%E6%A6%82%E8%BF%B0"><span class="toc-text">1.1、概述</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-2%E3%80%81%E7%89%B9%E6%80%A7"><span class="toc-text">1.2、特性</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81MyBatisPlus%E5%85%A5%E9%97%A8"><span class="toc-text">2、MyBatisPlus入门</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1%E3%80%81%E5%88%9B%E5%BB%BA%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE%E5%BA%93%E5%92%8C%E8%A1%A8"><span class="toc-text">2.1、创建测试数据库和表</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2%E3%80%81%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE%E5%92%8C%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96"><span class="toc-text">2.2、创建项目和添加依赖</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3%E3%80%81%E5%88%9B%E5%BB%BA%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-text">2.3、创建配置文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-4%E3%80%81%E7%BC%96%E5%86%99%E4%BB%A3%E7%A0%81"><span class="toc-text">2.4、编写代码</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81MyBatisPlus%E5%AE%9E%E7%8E%B0CRUD%E6%93%8D%E4%BD%9C"><span class="toc-text">3、MyBatisPlus实现CRUD操作</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-1%E3%80%81%E6%8F%92%E5%85%A5%E6%93%8D%E4%BD%9C"><span class="toc-text">3.1、插入操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2%E3%80%81%E4%B8%BB%E9%94%AE%E7%AD%96%E7%95%A5"><span class="toc-text">3.2、主键策略</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-3%E3%80%81%E6%A0%B9%E6%8D%AEId%E6%9B%B4%E6%96%B0%E6%93%8D%E4%BD%9C"><span class="toc-text">3.3、根据Id更新操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-4%E3%80%81%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2"><span class="toc-text">3.4、分页查询</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-5%E3%80%81%E6%A0%B9%E6%8D%AEid%E5%88%A0%E9%99%A4%E8%AE%B0%E5%BD%95"><span class="toc-text">3.5、根据id删除记录</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-6%E3%80%81%E6%89%B9%E9%87%8F%E5%88%A0%E9%99%A4"><span class="toc-text">3.6、批量删除</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-7%E3%80%81%E9%80%BB%E8%BE%91%E5%88%A0%E9%99%A4"><span class="toc-text">3.7、逻辑删除</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E3%80%81MyBatisPlus%E6%9D%A1%E4%BB%B6%E6%9E%84%E9%80%A0%E5%99%A8"><span class="toc-text">4、MyBatisPlus条件构造器</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#4-1%E3%80%81QueryWrapper-%E4%BD%BF%E7%94%A8"><span class="toc-text">4.1、QueryWrapper 使用</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-2%E3%80%81LambdaQueryWrapper-%E4%BD%BF%E7%94%A8"><span class="toc-text">4.2、LambdaQueryWrapper  使用</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E3%80%81MyBatisPlus%E5%B0%81%E8%A3%85Service%E5%B1%82"><span class="toc-text">5、MyBatisPlus封装Service层</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#5-1%E3%80%81%E5%88%9B%E5%BB%BAservice"><span class="toc-text">5.1、创建service</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-2%E3%80%81%E5%88%9B%E5%BB%BAservice%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="toc-text">5.2、创建service实现类</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-3%E3%80%81%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8%E6%B5%8B%E8%AF%95"><span class="toc-text">5.3、方法调用测试</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background: black"><div id="footer-wrap"><div class="footer_custom_text">Copyright © 2021 - 2023 <a href="https://yagote.github.io/">虾壳</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>